{"version":3,"sources":["js/editCal.js"],"names":["docDat","docId","savedInterval","store","firebase","storage","rtDb","database","lastSave","Date","now","saved","newMedia","newMedSrc","eventToShow","daysOfWeek","longDay","fullMonth","n","l","saveDoc","console","log","promises","Promise","langs","forEach","lang","syncUpt","published","finished","pastDue","public","sentMail","revised","translations","url","push","db","collection","doc","update","all","then","docRef","normSave","showEvent","clearInterval","setInterval","minutes","Math","floor","document","getElementById","innerText","catch","err","code","setprog","bar","setAttribute","style","width","Object","keys","events","key","hideEl","innerHTML","date","showEl","enable","render","weeks","week","wIdx","weekRow","createElement","height","appendChild","i","day","dayCell","classes","num","fontSize","maxHeight","event","idx","btnEvent","backgroundColor","borderColor","name","onclick","btnPlusEvent","length","description","visibilidad","horario","changed","form","id","bod","fsec","fg0","in0","fg1","in1","fg2","in2","visOpts","itm","opt","value","fg3","in3","oninput","reverBtn","tsec","eveTit","eveDesc","eveVis","eveTime","eveTimeLst","time","li","foot","delBtn","Number","substr","splice","$","modal","editBtn","indexOf","saveBtn","disable","trim","split","entries","resetChgImg","uncheck","src","picUrl","checked","removeAttribute","validateRevision","revLangs","rev","includes","uid","newCal","nextCalID","ref","transaction","nCal","error","days","getMonth","getFullYear","bDay","getDay","j","newC","firestore","Timestamp","fromDate","descriptionShort","picAlt","picCapt","title","nextCal","priorCal","intId","parseInt","year","nYear","pYear","month","nMonth","toLowerCase","pMonth","calsText","abs","toString","set","window","loaded","calendarsFSRef","urlSrch","get","onSnapshot","exists","data","href","location","addEventListener","preventDefault","addMed","put","on","snap","bytesTransferred","totalBytes","setTimeout","click","getDownloadURL","medUrl","picDesc","picDescShort","orderedKeys","slice","sort","a","b","substring","toggleEl","e","prevMed","read","target","files","ultraClean","FileReader","readAsDataURL","onload","e2","result","onchange","timePrev","fromMillis","getTime","admin","pop","open","focus"],"mappings":"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","file":"editCal.b417d5d0.js","sourceRoot":"../src","sourcesContent":["import '../styles/editCal.scss';\n\nvar store = firebase.storage();\nvar rtDb = firebase.database();\n\nlet docDat, docId;\nlet lastSave = Date.now(), saved = false;\n\nlet newMedia = null;\nlet newMedSrc = null;\n\nlet eventToShow = null;\n\nconst daysOfWeek = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'], longDay = ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sabado'];\nfunction fullMonth(n, l) {\n    if (l == \"es\") {\n        switch (n) {\n            case 1:\n                return \"Enero\";\n            case 2:\n                return \"Febrero\";\n            case 3:\n                return \"Marzo\";\n            case 4:\n                return \"Abril\";\n            case 5:\n                return \"Mayo\";\n            case 6:\n                return \"Junio\";\n            case 7:\n                return \"Julio\";\n            case 8:\n                return \"Agosto\";\n            case 9:\n                return \"Septiembre\";\n            case 10:\n                return \"Octubre\";\n            case 11:\n                return \"Noviembre\";\n            case 12:\n                return \"Diciembre\";\n            case 0:\n                return \"Diciembre\";\n            case 13:\n                return \"Enero\";\n        }\n    } else if (l == \"en\") {\n        switch (n) {\n            case 1:\n                return \"January\";\n            case 2:\n                return \"February\";\n            case 3:\n                return \"March\";\n            case 4:\n                return \"April\";\n            case 5:\n                return \"May\";\n            case 6:\n                return \"June\";\n            case 7:\n                return \"July\";\n            case 8:\n                return \"August\";\n            case 9:\n                return \"September\";\n            case 10:\n                return \"October\";\n            case 11:\n                return \"November\";\n            case 12:\n                return \"December\";\n            case 0:\n                return \"December\";\n            case 13:\n                return \"January\";\n        }\n    }\n}\n\nwindow.loaded = function loaded() {\n    calendarsFSRef.doc(urlSrch.get('id')).onSnapshot(doc => {\n        if (!doc.exists) {\n            window.location.href = '../404';\n            return;\n        }\n        docDat = doc.data();\n        docId = doc.id;\n        document.getElementById('title').innerHTML = docDat.title;\n        document.getElementById('prevMed').src = docDat.picUrl;\n        document.getElementById('inPicCapt').value = docDat.picCapt;\n        document.getElementById('inPicAlt').value = docDat.picAlt;\n        document.getElementById('inDesc').value = docDat.description;\n        document.getElementById('inDescShort').value = docDat.descriptionShort;\n        render();\n        if (docDat.public) {\n            hideEl(document.getElementById('btnAprove'));\n            hideEl(document.getElementById('btnPub'));\n        } else {\n            showEl(document.getElementById('btnAprove'));\n            if (docDat.pastDue) showEl(document.getElementById('btnPub'));\n        }\n        if (docDat.revised.includes(uid)) {\n            document.getElementById('btnAprove').innerHTML = '<i class=\"fas fa-check-square\"></i>';\n        } else {\n            document.getElementById('btnAprove').innerHTML = '<i class=\"far fa-check-square\"></i>';\n        }\n        document.getElementById('btnPrevCal').href = docDat.url;\n        document.getElementById('btnPrevMail').href = '/vista-email-calendario/' + docId;\n        document.getElementById('btnSrcCal').href = `https://in-the-sky.org/newscal.php?month=${urlSrch.get('id').substr(5, 6)}&year=${urlSrch.get('id').substr(0, 4)}&maxdiff=7&country=1484&reg1=3527646&reg2=8379372&town=3530597`;\n        document.getElementById('btnSrcCal2').href = `https://in-the-sky.org/newscal.php?month=${urlSrch.get('id').substr(5, 6)}&year=${urlSrch.get('id').substr(0, 4)}&maxdiff=7&country=1170&reg1=3688685&reg2=9609540&town=3688689`;\n        document.getElementById('btnSrcCal3').href = `https://in-the-sky.org/newscal.php?month=${urlSrch.get('id').substr(5, 6)}&year=${urlSrch.get('id').substr(0, 4)}&maxdiff=7&country=1724&reg1=3117732&reg2=6355233&town=3117735`;\n    }, err => console.log(err))\n\n    function descFrm() {\n        docDat.description = document.getElementById('inDesc').value.trim();\n        docDat.descriptionShort = document.getElementById('inDescShort').value.trim();\n        normSave();\n    }\n    document.getElementById(\"frmText\").addEventListener(\"submit\", function (event) {\n        event.preventDefault();\n        descFrm();\n    });\n\n    function addMed() {\n        let ref = store.ref('calendarMedia/' + docId + '/pic');\n        ref.put(newMedia).on('state_changed',\n            function progress(snap) {\n                setprog(document.getElementById('barChgImg'), (snap.bytesTransferred / snap.totalBytes) * 100);\n            },\n            function error(err) {\n                document.getElementById(\"alrtClsSsn\").innerHTML = '<div id=\"alrtClsSsnAlrt\" class=\"alert alert-warning alert-dismissible fade show fixed-bottom\" role=\"alert\"><strong>¡Ocurrió un error!</strong> ' + err.code + '<button id=\"btnAlrtClsSsn\" type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button></div>';\n                setTimeout(function () {\n                    if (document.getElementById(\"btnAlrtClsSsn\")) document.getElementById(\"btnAlrtClsSsn\").click();\n                }, 3000);\n                console.log(err);\n                $('#mdlAddMed').modal('hide');\n            },\n            function complete() {\n                ref.getDownloadURL().then(medUrl => {\n                    docDat.picUrl = medUrl;\n                    normSave();\n                    resetChgImg(true);\n                    hideEl(document.getElementById(\"frmChgImg\"));\n                }).catch(err => { console.log(err) });\n            }\n        );\n    }\n    function addExtMed() {\n        docDat.picUrl = document.getElementById('inChgImgUrl').value;\n        normSave();\n        resetChgImg(true);\n        hideEl(document.getElementById(\"frmChgImg\"));\n    }\n    document.getElementById(\"frmChgImg\").addEventListener(\"submit\", function (event) {\n        event.preventDefault();\n        setprog(document.getElementById('barChgImg'), 0);\n        showEl(document.getElementById(\"barChgImgCont\"));\n        hideEl(document.getElementById(\"frmChgImg\"));\n        document.getElementById(\"btnCnfChgImg\").setAttribute('disabled', 'true');\n        document.getElementById(\"btnCanChgImg\").setAttribute('disabled', 'true');\n        if (newMedSrc == \"home\") addMed();\n        else addExtMed();\n    });\n}\n\ndocument.getElementById('inPicCapt').oninput = () => {\n    docDat.picCapt = document.getElementById('inPicCapt').value.trim();\n}\ndocument.getElementById('inPicAlt').oninput = () => {\n    docDat.picAlt = document.getElementById('inPicAlt').value.trim();\n}\ndocument.getElementById('inDesc').oninput = () => {\n    docDat.picDesc = document.getElementById('inDesc').value.trim();\n}\ndocument.getElementById('inDescShort').oninput = () => {\n    docDat.picDescShort = document.getElementById('inDescShort').value.trim();\n}\n\nlet savedInterval;\nfunction saveDoc() {\n    console.log('Saving...');\n\n    const promises = [];\n    langs.forEach(l => {\n        if (l != lang) {\n            let syncUpt = {\n                published: docDat.published,\n                finished: docDat.finished,\n                pastDue: docDat.pastDue,\n                public: docDat.public,\n                sentMail: docDat.sentMail,\n                revised: docDat.revised,\n                translations: docDat.translations,\n            }\n            syncUpt.translations[lang] = docDat.url;\n            promises.push(db.collection('cookies/langs/' + l).doc(docId).update(syncUpt));\n        }\n    })\n    return Promise.all(promises).then(() => {\n        return docRef.update(docDat);\n    });\n}\nfunction normSave() {\n    saveDoc().then(() => {\n        if (eventToShow) showEvent();//IMPORTANT\n        if (saved) clearInterval(savedInterval);\n        saved = true;\n        savedInterval = setInterval(() => {\n            let minutes = Math.floor((Date.now() - lastSave) / 60000);\n            if (minutes < 60) document.getElementById('tagLstSave').innerText = \"Guardado hace \" + minutes + \" minutos\";\n            else document.getElementById('tagLstSave').innerText = \"Guardado hace \" + Math.floor(minutes / 60) + \" horas\";\n        }, 300010);\n        document.getElementById('tagLstSave').innerText = \"Se han guardado los cambios\";\n        lastSave = Date.now();\n    }).catch(err => {\n        document.getElementById('tagLstSave').innerText = \"Error, no se han guardado todos los cambios: \" + err.code;\n        console.log(err);\n    });\n}\n\nfunction setprog(bar, n) {\n    n = Math.floor(n);\n    bar.setAttribute('aria-valuenow', n);\n    bar.style.width = n + '%';\n    bar.innerText = n + '%';\n}\n\nfunction showEvent() {\n    Object.keys(docDat.events).forEach(key => {\n        hideEl(document.getElementById(key));\n    });\n    document.getElementById('mdlEventInfoL').innerHTML = docDat.events[eventToShow].date;\n    showEl(document.getElementById(eventToShow));\n    enable(document.getElementById('btnPriorEve'));\n    enable(document.getElementById('btnNextEve'));\n}\ndocument.getElementById('btnPriorEve').onclick = () => {\n    let orderedKeys = Object.keys(docDat.events).slice().sort((a, b) => {\n        if (Number(a[0]) == Number(b[0])) {\n            if (a.substring(1, 4) == b.substring(1, 4)) {\n                return Number(a[4]) - Number(b[4]);\n            }\n            switch (a.substring(1, 4)) {\n                case \"sun\":\n                    return -1;\n                case \"mon\":\n                    if (b.substring(1, 4) == \"sun\") return 1;\n                    return -1;\n                case \"tue\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\") return 1\n                    return -1;\n                case \"wed\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\") return 1\n                    return -1;\n                case \"thu\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\") return 1\n                    return -1;\n                case \"fri\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\" || b.substring(1, 4) == \"thu\") return 1\n                    return -1;\n                case \"sat\":\n                    return 1;\n            }\n        }\n        return Number(a[0]) - Number(b[0]);\n    });\n    let n = orderedKeys.indexOf(eventToShow) - 1;\n    if (n >= 0) {\n        eventToShow = orderedKeys[n];\n        showEvent();\n    } else {\n        disable(document.getElementById('btnPriorEve'));\n    }\n};\ndocument.getElementById('btnNextEve').onclick = () => {\n    let orderedKeys = Object.keys(docDat.events).slice().sort((a, b) => {\n        if (Number(a[0]) == Number(b[0])) {\n            if (a.substring(1, 4) == b.substring(1, 4)) {\n                return Number(a[4]) - Number(b[4]);\n            }\n            switch (a.substring(1, 4)) {\n                case \"sun\":\n                    return -1;\n                case \"mon\":\n                    if (b.substring(1, 4) == \"sun\") return 1;\n                    return -1;\n                case \"tue\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\") return 1\n                    return -1;\n                case \"wed\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\") return 1\n                    return -1;\n                case \"thu\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\") return 1\n                    return -1;\n                case \"fri\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\" || b.substring(1, 4) == \"thu\") return 1\n                    return -1;\n                case \"sat\":\n                    return 1;\n            }\n        }\n        return Number(a[0]) - Number(b[0]);\n    });\n    let n = orderedKeys.indexOf(eventToShow) + 1;\n    if (n < orderedKeys.length) {\n        eventToShow = orderedKeys[n];\n        showEvent();\n    } else {\n        disable(document.getElementById('btnNextEve'));\n    }\n};\n\nfunction render() {\n    document.getElementById('weeksCont').innerHTML = \"\";\n    docDat.weeks.forEach((week, wIdx) => {\n        let weekRow = document.createElement('tr');\n        weekRow.style.height = '10rem';\n        document.getElementById('weeksCont').appendChild(weekRow);\n        for (let i = 0; i < 7; i++) {\n            let day = week[daysOfWeek[i]]\n            let dayCell = document.createElement('td');\n            classes(dayCell, \"p-0\");\n            weekRow.appendChild(dayCell);\n            if (day) {\n                let num = document.createElement('p');\n                classes(num, \"m-0 p-1\");\n                num.style.fontSize = 'x-large';\n                num.innerHTML = '<b>' + day.date + '</b>';\n                dayCell.appendChild(num);\n\n                let events = document.createElement('div');\n                classes(events, \"autoOverflow\");\n                events.style.maxHeight = '7rem';\n                day.events.forEach((event, idx) => {\n                    let btnEvent = document.createElement('button');\n                    btnEvent.setAttribute(\"data-toggle\", \"modal\");\n                    btnEvent.setAttribute(\"data-target\", \"#mdlEventInfo\");\n                    classes(btnEvent, \"btn text-left p-1 mb-1 w-100\");\n                    btnEvent.style.backgroundColor = \"#c3e6cb\";\n                    btnEvent.style.borderColor = \"#8fd19e\";\n                    btnEvent.innerHTML = '<small>' + event.name + '</small>';\n                    btnEvent.onclick = () => {\n                        eventToShow = wIdx + daysOfWeek[i] + idx;\n                        showEvent();\n                    }\n                    events.appendChild(btnEvent);\n                });\n                let btnPlusEvent = document.createElement('button');\n                classes(btnPlusEvent, \"btn btn-scckie btn-block btn-sm\");\n                btnPlusEvent.innerHTML = '<i class=\"fas fa-plus\"></i>';\n                btnPlusEvent.onclick = () => {\n                    docDat.events[wIdx + daysOfWeek[i] + day.events.length] = {\n                        date: longDay[i] + \" \" + day.date + \" de \" + fullMonth(docId % 100),\n                        name: \"Evento sin nombre\",\n                        description: \"Sin descripción\",\n                        visibilidad: \"Visible a simple vista\",\n                        horario: [\"Ciudad de México:\", \"Bogotá:\", \"Madrid:\"]\n                    };\n                    day.events.push({\n                        name: \"Evento sin nombre\"\n                    });\n                    normSave();\n                }\n                events.appendChild(btnPlusEvent);\n                dayCell.appendChild(events);\n            }\n        }\n    });\n    document.getElementById('eventInfoCont').innerHTML = \"\";\n    for (const [key, event] of Object.entries(docDat.events)) {\n        let changed = false;\n        let form = document.createElement('div');\n        form.id = key;\n        classes(form, \"d-none overflow-auto\");\n        let bod = document.createElement('div');\n        classes(bod, \"modal-body\");\n        form.appendChild(bod);\n\n        let fsec = document.createElement('div');\n        classes(fsec, \"d-none\");\n        bod.appendChild(fsec);\n        let fg0 = document.createElement('div');\n        classes(fg0, \"form-group\");\n        fsec.appendChild(fg0);\n        fg0.innerHTML = '<label>Nombre del evento</label>';\n        let in0 = document.createElement('input');\n        in0.id = \"inEveTitle\" + key;\n        in0.setAttribute(\"type\", \"text\");\n        classes(in0, \"form-control\");\n        fg0.appendChild(in0);\n        let fg1 = document.createElement('div');\n        classes(fg1, \"form-group\");\n        fsec.appendChild(fg1);\n        fg1.innerHTML = '<label>Descripción</label>';\n        let in1 = document.createElement('textarea');\n        classes(in1, \"form-control\");\n        in1.id = \"inEveDesc\" + key;\n        in1.setAttribute(\"rows\", \"3\");\n        fg1.appendChild(in1);\n        let fg2 = document.createElement('div');\n        classes(fg2, \"form-group\");\n        fsec.appendChild(fg2);\n        fg2.innerHTML = '<label>Visiblidad</label>';\n        let in2 = document.createElement('select');\n        in2.id = \"inVis\" + key;\n        classes(in2, \"form-control\");\n        let visOpts = [\"Visible a simple vista\", \"Visible con binoculares\", \"Visible con un telescopio pequeño\", \"Visible con un telescopio de 4 pulgadas\", \"Visible con un telescopio grande\", \"No observable\"]\n        visOpts.forEach((itm, idx) => {\n            let opt = document.createElement('option');\n            opt.value = idx;\n            opt.innerHTML = itm;\n            if (itm == event.visibilidad) opt.setAttribute('selected', \"true\");\n            in2.appendChild(opt);\n        });\n        fg2.appendChild(in2);\n        let fg3 = document.createElement('div');\n        classes(fg3, \"form-group\");\n        fsec.appendChild(fg3);\n        fg3.innerHTML = '<label>Horario</label>';\n        let in3 = document.createElement('textarea');\n        classes(in3, \"form-control\");\n        in3.id = \"inTime\" + key;\n        in3.setAttribute(\"rows\", \"4\");\n        fg3.appendChild(in3);\n        if (in2.value == 5) hideEl(fg3);\n        else showEl(fg3);\n        in0.oninput = () => {\n            enable(reverBtn);\n            changed = true;\n        };\n        in1.oninput = () => {\n            enable(reverBtn);\n            changed = true;\n        };\n        in2.oninput = () => {\n            enable(reverBtn);\n            changed = true;\n            if (in2.value == 5) hideEl(fg3);\n            else showEl(fg3);\n        };\n        in3.oninput = () => {\n            enable(reverBtn);\n            changed = true;\n        };\n\n        let tsec = document.createElement('div');\n        bod.appendChild(tsec);\n        let eveTit = document.createElement('h3');\n        eveTit.innerHTML = event.name;\n        tsec.appendChild(eveTit);\n        let eveDesc = document.createElement('p');\n        eveDesc.innerHTML = event.description;\n        tsec.appendChild(eveDesc);\n        let eveVis = document.createElement('p');\n        eveVis.innerHTML = \"Visibilidad: \" + event.visibilidad;\n        tsec.appendChild(eveVis);\n        let eveTime = document.createElement('p');\n        classes(eveTime, \"mb-0\");\n        eveTime.innerHTML = \"Horario: \";\n        tsec.appendChild(eveTime);\n        let eveTimeLst = document.createElement('ul');\n        tsec.appendChild(eveTimeLst);\n        event.horario.forEach(time => {\n            let li = document.createElement('li');\n            li.innerHTML = time;\n            eveTimeLst.appendChild(li);\n        });\n        if (event.visibilidad == \"No observable\") {\n            hideEl(eveTime);\n            hideEl(eveTimeLst);\n        }\n        else {\n            showEl(eveTime);\n            showEl(eveTimeLst);\n        }\n\n\n        let foot = document.createElement('div');\n        classes(foot, \"modal-footer\");\n        form.appendChild(foot);\n\n        let delBtn = document.createElement('button');\n        classes(delBtn, \"btn btn-danger mr-auto\")\n        delBtn.setAttribute(\"type\", \"button\");\n        delBtn.innerText = \"Borrar\";\n        delBtn.onclick = () => {\n            for (let i = Number(key.substr(4)) + 1; i < docDat.weeks[Number(key[0])][key.substr(1, 3)].events.length; i++) {\n                docDat.events[key.substr(0, 4) + (i - 1)] = docDat.events[key.substr(0, 4) + i]\n            }\n            delete docDat.events[key.substr(0, 4) + (docDat.weeks[Number(key[0])][key.substr(1, 3)].events.length - 1)];\n            docDat.weeks[Number(key[0])][key.substr(1, 3)].events.splice(Number(key.substr(4)), 1);\n            $('#mdlEventInfo').modal('hide');\n            eventToShow = null;\n            normSave();\n        };\n        foot.appendChild(delBtn);\n        let editBtn = document.createElement('button');\n        classes(editBtn, \"btn btn-info\");\n        editBtn.setAttribute(\"type\", \"button\");\n        editBtn.innerText = \"Editar\";\n        editBtn.onclick = () => {\n            in0.value = event.name;\n            in1.innerHTML = event.description;\n            in2.value = visOpts.indexOf(event.visibilidad);\n            if (in2.value == 5) hideEl(fg3);\n            else showEl(fg3);\n            in3.innerHTML = \"\";\n            event.horario.forEach(time => {\n                in3.innerHTML += time + \"\\n\";\n            });\n            hideEl(tsec);\n            showEl(fsec);\n            showEl(reverBtn);\n            showEl(saveBtn);\n            enable(saveBtn);\n            hideEl(editBtn);\n        };\n        foot.appendChild(editBtn);\n        let reverBtn = document.createElement('button');\n        classes(reverBtn, \"btn btn-secondary mr-1 d-none\");\n        reverBtn.setAttribute(\"type\", \"button\");\n        disable(reverBtn);\n        reverBtn.innerText = \"Revertir\";\n        reverBtn.onclick = () => {\n            changed = false;\n            disable(reverBtn);\n            in0.value = event.name;\n            in1.innerHTML = event.description;\n            in2.value = visOpts.indexOf(event.visibilidad);\n            if (in2.value == 5) hideEl(fg3);\n            else showEl(fg3);\n            in3.innerHTML = \"\";\n            event.horario.forEach(time => {\n                in3.innerHTML += time.trim() + \"\\n\";\n            });\n        };\n        foot.appendChild(reverBtn);\n        let saveBtn = document.createElement('button');\n        classes(saveBtn, \"btn btn-scckie d-none\");\n        saveBtn.setAttribute(\"type\", \"button\");\n        disable(saveBtn);\n        saveBtn.innerText = \"Guardar\";\n        saveBtn.onclick = () => {\n            disable(reverBtn);\n            disable(saveBtn);\n            if (changed) {\n                docDat.weeks[Number(key[0])][key.substr(1, 3)].events[key[4]].name = event.name = in0.value;\n                event.description = in1.value.trim();\n                event.visibilidad = visOpts[in2.value];\n                event.horario = [];\n                in3.value.trim().split('\\n').forEach(time => {\n                    if (time != \"\" && time != \" \") event.horario.push(time);\n                });\n                normSave();\n            } else {\n                hideEl(fsec);\n                showEl(tsec);\n                hideEl(reverBtn);\n                hideEl(saveBtn);\n                showEl(editBtn);\n            }\n        };\n        foot.appendChild(saveBtn);\n\n        document.getElementById('eventInfoCont').appendChild(form);\n    }\n}\n\n\nfunction resetChgImg(uncheck) {\n    document.getElementById('prevMed').src = docDat.picUrl;\n    if (uncheck) {\n        document.getElementById('inMedSrc0').checked = false;\n        document.getElementById('inMedSrc1').checked = false;\n    }\n    document.getElementById('inChgImg').value = \"\";\n    document.getElementById('inChgImgUrl').value = \"\";\n    document.getElementById('inChgImg').removeAttribute('required');\n    document.getElementById('inChgImgUrl').removeAttribute('required');\n    hideEl(document.getElementById(\"barChgImgCont\"));\n    hideEl(document.getElementById(\"inChgImgFileCont\"));\n    hideEl(document.getElementById(\"inChgImgUrlCont\"));\n    document.getElementById(\"btnCnfChgImg\").removeAttribute('disabled');\n    document.getElementById(\"btnCanChgImg\").removeAttribute('disabled');\n}\ndocument.getElementById('btnChgImg').onclick = () => {\n    resetChgImg(true);\n    toggleEl(document.getElementById(\"frmChgImg\"));\n};\ndocument.getElementById('inChgImg').addEventListener('change', e => {\n    newMedia = e.target.files[0];\n    function prevMed() {\n        var read = new FileReader();\n        read.readAsDataURL(newMedia);\n        read.onload = function (e2) {\n            document.getElementById(\"prevMed\").src = e2.target.result;\n        };\n    };\n    newMedia.name = ultraClean(newMedia.name, '');\n    document.getElementById('inChgImgL').innerHTML = newMedia.name;\n    prevMed(newMedia);\n});\ndocument.getElementById('inChgImgUrl').onchange = function () {\n    document.getElementById(\"prevMed\").src = document.getElementById('inChgImgUrl').value;\n};\ndocument.getElementById('inMedSrc0').onclick = function () {\n    newMedSrc = \"home\";\n    resetChgImg(false);\n    document.getElementById('inChgImg').setAttribute('required', 'true');\n    showEl(document.getElementById(\"inChgImgFileCont\"));\n}\ndocument.getElementById('inMedSrc1').onclick = function () {\n    newMedSrc = \"out\";\n    resetChgImg(false);\n    document.getElementById('inChgImgUrl').setAttribute('required', 'true');\n    showEl(document.getElementById(\"inChgImgUrlCont\"));\n}\n\ndocument.getElementById('btnPrevCal').onclick = function () {\n    docDat.timePrev = new firebase.firestore.Timestamp.fromMillis((new Date(Date.now())).getTime() + 900000);\n    normSave();\n};\ndocument.getElementById('btnPrevMail').onclick = function () {\n    docDat.timePrev = new firebase.firestore.Timestamp.fromMillis((new Date(Date.now())).getTime() + 900000);\n    normSave();\n};\n\nfunction validateRevision() {\n    let revLangs = 0;\n    langs.forEach(l => {\n        let rev = docDat.revised[l] ? docDat.revised[l].length : 0;\n        if (docDat.revised[l] && !docDat.revised[l].includes(uid)) rev++;\n        if (rev >= 2) revLangs++;\n    });\n    return revLangs == langs.length;\n}\n\ndocument.getElementById('btnAprove').onclick = function () {\n    if (docDat.revised[lang] && docDat.revised[lang].includes(uid)) {\n        docDat.revised[lang].splice(docDat.revised[lang].indexOf(uid), 1);\n        document.getElementById('btnAprove').innerHTML = '<i class=\"far fa-check-square\"></i>';\n    } else {\n        if (!docDat.revised[lang]) docDat.revised[lang] = [];\n        docDat.revised[lang].push(uid);\n        document.getElementById('btnAprove').innerHTML = '<i class=\"fas fa-check-square\"></i>';\n    }\n    if (validateRevision()) {\n        docDat.finished = true;\n        newCal();\n    } else {\n        docDat.finished = false;\n    }\n    normSave();\n};\n\nfunction newCal() {\n    let nextCalID;\n    rtDb.ref('nextCal').transaction(nCal => {\n        if (nCal) {\n            nextCalID = nCal;\n            nCal++;\n            if (nCal % 100 == 13) {\n                nCal -= 12;\n                nCal += 100;\n            }\n        }\n        return nCal;\n    }, (error) => {\n        if (error) {\n            console.log(error);\n        } else {\n            let date = new Date((nextCalID - nextCalID % 100) / 100 + ' ' + nextCalID % 100 + ' ' + '00:00');\n            let weeks = [];\n            let days;\n            if (date.getMonth() == 1) {\n                if (date.getFullYear() % 4 == 0) {\n                    days = 29;\n                } else {\n                    days = 28;\n                }\n            } else if (date.getMonth() % 2 == 0) {\n                if (date.getMonth() <= 6) days = 31;\n                else days = 30;\n            } else {\n                if (date.getMonth() <= 6) days = 30;\n                else days = 31;\n            }\n            let bDay = date.getDay();\n            for (let i = 1; i <= days; i = i) {\n                let week = {};\n                for (let j = bDay; j < daysOfWeek.length; j++) {\n                    if (i > days) break;\n                    week[daysOfWeek[j]] = {\n                        date: i,\n                        events: []\n                    }\n                    i++;\n                }\n                weeks.push(week);\n                bDay = 0;\n            }\n            const promises = [];\n            langs.forEach(l => {\n                if (l != lang) {\n                    let newC = {\n                        events: {},\n                        published: firebase.firestore.Timestamp.fromDate(date),\n                        description: \"\",\n                        descriptionShort: \"\",\n                        finished: false,\n                        pastDue: false,\n                        picUrl: \"\",\n                        picAlt: \"\",\n                        picCapt: \"\",\n                        public: false,\n                        sentMail: false,\n                        revised: {},\n                        title: \"\",\n                        url: \"\",\n                        nextCal: \"\",\n                        priorCal: \"\",\n                        weeks: weeks,\n                        translations: {}\n                    }\n\n                    let intId = parseInt(nextCalID);\n                    let year = (intId - intId % 100) / 100;\n                    let nYear = (intId - intId % 100) / 100;\n                    let pYear = (intId - intId % 100) / 100;\n                    if (intId % 100 == 12) nYear++;\n                    if (intId % 100 == 1) pYear--;\n                    let month = fullMonth(intId % 100);\n                    let nMonth = fullMonth(intId % 100 + 1).toLowerCase();\n                    let pMonth = fullMonth(intId % 100 - 1).toLowerCase();\n                    let calsText = \"\";\n                    switch (l) {\n                        case \"es\":\n                            calsText = \"calendario-astronomico\";\n                            newC.title = \"Calendario Astronómico de \" + month + \" \" + year;\n                            break;\n                        case \"en\":\n                            calsText = \"astronomic-calendar\";\n                            newC.title = \"Astronomic Calendar of \" + month + \" \" + year;\n                            break;\n                    }\n                    newC.url = \"https://sciencecookies.net/\" + calsText + \"/\" + year + \"/\" + month.toLowerCase() + \"/\";\n                    newC.nextCal = \"https://sciencecookies.net/\" + calsText + \"/\" + nYear + \"/\" + nMonth + \"/\";\n                    newC.priorCal = \"https://sciencecookies.net/\" + calsText + \"/\" + pYear + \"/\" + pMonth + \"/\";\n\n                    promises.push(db.collection('calendars/langs/' + l).doc(Math.abs(nextCalID).toString()).set(newC));\n                }\n            })\n            return Promise.all(promises).then(() => {\n                console.log('exito');\n            }).catch(err => console.log(err));\n        }\n    });\n}\n\n$('#mdlPublish').on('show.bs.modal', e => {\n    if (validateRevision()) {\n        showEl(document.getElementById('btnCnfPublish'));\n        document.getElementById('mdlPublishTxt').innerText = \"El calendario está listo para publicar\";\n    } else {\n        hideEl(document.getElementById('btnCnfPublish'));\n        document.getElementById('mdlPublishTxt').innerText = \"Para publicar es necesario que lo hayan aprovado al menos dos personas.\";\n    }\n});\n\ndocument.getElementById('btnCnfPublish').onclick = function () {\n    if (docDat.public) return;\n    setprog(document.getElementById('barPublish'), 0);\n    showEl(document.getElementById('barPublishCont'));\n\n    docDat.public = true;\n    setprog(document.getElementById('barPublish'), 25);\n\n    saveDoc().then(() => {\n        setprog(document.getElementById('barPublish'), 58);\n        admin.database().ref('calendarios/' + docId).set({\n            pop: 0\n        }, err => {\n            if (err) {\n                document.getElementById(\"alrtClsSsn\").innerHTML = '<div id=\"alrtClsSsnAlrt\" class=\"alert alert-danger alert-dismissible fade show fixed-bottom\" role=\"alert\"><strong>!Ha ocurrido un error! </strong>' + err + '<button id=\"btnAlrtClsSsn\" type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button></div>';\n                console.log(err);\n                setTimeout(function () {\n                    document.getElementById(\"btnAlrtClsSsn\").click();\n                }, 3000);\n                $('#alrtClsSsnAlrt').on('closed.bs.alert', function () {\n                    document.getElementById(\"alrtClsSsn\").innerHTML = '';\n                });\n            } else {\n                setprog(document.getElementById('barPublish'), 100);\n                classes(document.getElementById('barPublish'), 'bg-success');\n                document.getElementById(\"alrtClsSsn\").innerHTML = '<div id=\"alrtClsSsnAlrt\" class=\"alert alert-success alert-dismissible fade show fixed-bottom\" role=\"alert\">Publicado correctamente <button id=\"btnAlrtClsSsn\" type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button></div>';\n                setTimeout(function () {\n                    window.open(docDat.url, '_blank').focus();\n                }, 2500);\n                console.log(\"Published successfully.\");\n                setTimeout(function () {\n                    document.getElementById(\"btnAlrtClsSsn\").click();\n                }, 3000);\n                $('#alrtClsSsnAlrt').on('closed.bs.alert', function () {\n                    document.getElementById(\"alrtClsSsn\").innerHTML = '';\n                });\n                $('#mdlPublish').modal('hide');\n                console.log('Published ' + docId + ' calendar');\n                return null;\n            }\n        });\n    }).catch(error => {\n        document.getElementById(\"alrtClsSsn\").innerHTML = '<div id=\"alrtClsSsnAlrt\" class=\"alert alert-danger alert-dismissible fade show fixed-bottom\" role=\"alert\"><strong>!Ha ocurrido un error! </strong>' + error + '<button id=\"btnAlrtClsSsn\" type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button></div>';\n        console.log(error);\n        setTimeout(function () {\n            document.getElementById(\"btnAlrtClsSsn\").click();\n        }, 3000);\n        $('#alrtClsSsnAlrt').on('closed.bs.alert', function () {\n            document.getElementById(\"alrtClsSsn\").innerHTML = '';\n        });\n    });\n};"]}