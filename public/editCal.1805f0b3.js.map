{"version":3,"sources":["js/editCal.js"],"names":["store","firebase","storage","rtDb","database","docDat","docId","lastSave","Date","now","saved","newMedia","newMedSrc","eventToShow","daysOfWeek","longDay","fullMonth","n","l","savedInterval","saveDoc","console","log","promises","Promise","langs","forEach","lang","syncUpt","published","finished","pastDue","public","sentMail","revised","translations","url","push","db","collection","doc","update","all","then","docRef","normSave","showEvent","clearInterval","setInterval","minutes","Math","floor","document","getElementById","innerText","catch","err","code","setprog","bar","setAttribute","style","width","Object","keys","events","key","hideEl","innerHTML","date","showEl","enable","render","weeks","week","wIdx","weekRow","createElement","height","appendChild","i","day","dayCell","classes","num","fontSize","maxHeight","event","idx","btnEvent","backgroundColor","borderColor","name","onclick","btnPlusEvent","length","description","visibilidad","horario","entries","changed","form","id","bod","fsec","fg0","in0","fg1","in1","fg2","in2","visOpts","itm","opt","value","fg3","in3","oninput","reverBtn","tsec","eveTit","eveDesc","eveVis","eveTime","eveTimeLst","time","li","foot","delBtn","Number","substr","splice","$","modal","editBtn","indexOf","saveBtn","disable","trim","split","resetChgImg","uncheck","src","picUrl","checked","removeAttribute","validateRevision","revLangs","rev","includes","uid","newCal","nextCalID","ref","transaction","nCal","error","days","getMonth","getFullYear","bDay","getDay","j","newC","firestore","Timestamp","fromDate","descriptionShort","picAlt","picCapt","title","nextCal","priorCal","intId","parseInt","year","nYear","pYear","month","nMonth","toLowerCase","pMonth","calsText","abs","toString","set","window","loaded","calendarsFSRef","urlSrch","get","onSnapshot","exists","data","href","location","addEventListener","preventDefault","addMed","put","on","snap","bytesTransferred","totalBytes","alertTop","getDownloadURL","medUrl","picDesc","picDescShort","orderedKeys","slice","sort","a","b","substring","toggleEl","e","target","files","ultraClean","prevMed","read","FileReader","readAsDataURL","onload","e2","result","onchange","timePrev","fromMillis","getTime","admin","pop","setTimeout","open","focus"],"mappings":"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","file":"editCal.1805f0b3.js","sourceRoot":"../src","sourcesContent":["import '../styles/editCal.scss';\n\nvar store = firebase.storage();\nvar rtDb = firebase.database();\n\nlet docDat, docId;\nlet lastSave = Date.now(), saved = false;\n\nlet newMedia = null;\nlet newMedSrc = null;\n\nlet eventToShow = null;\n\nconst daysOfWeek = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'], longDay = ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sabado'];\nfunction fullMonth(n, l) {\n    if (l == \"es\") {\n        switch (n) {\n            case 1:\n                return \"Enero\";\n            case 2:\n                return \"Febrero\";\n            case 3:\n                return \"Marzo\";\n            case 4:\n                return \"Abril\";\n            case 5:\n                return \"Mayo\";\n            case 6:\n                return \"Junio\";\n            case 7:\n                return \"Julio\";\n            case 8:\n                return \"Agosto\";\n            case 9:\n                return \"Septiembre\";\n            case 10:\n                return \"Octubre\";\n            case 11:\n                return \"Noviembre\";\n            case 12:\n                return \"Diciembre\";\n            case 0:\n                return \"Diciembre\";\n            case 13:\n                return \"Enero\";\n        }\n    } else if (l == \"en\") {\n        switch (n) {\n            case 1:\n                return \"January\";\n            case 2:\n                return \"February\";\n            case 3:\n                return \"March\";\n            case 4:\n                return \"April\";\n            case 5:\n                return \"May\";\n            case 6:\n                return \"June\";\n            case 7:\n                return \"July\";\n            case 8:\n                return \"August\";\n            case 9:\n                return \"September\";\n            case 10:\n                return \"October\";\n            case 11:\n                return \"November\";\n            case 12:\n                return \"December\";\n            case 0:\n                return \"December\";\n            case 13:\n                return \"January\";\n        }\n    }\n}\n\nwindow.loaded = function loaded() {\n    calendarsFSRef.doc(urlSrch.get('id')).onSnapshot(doc => {\n        if (!doc.exists) {\n            window.location.href = '../404';\n            return;\n        }\n        docDat = doc.data();\n        docId = doc.id;\n        document.getElementById('title').innerHTML = docDat.title;\n        document.getElementById('prevMed').src = docDat.picUrl;\n        document.getElementById('inPicCapt').value = docDat.picCapt;\n        document.getElementById('inPicAlt').value = docDat.picAlt;\n        document.getElementById('inDesc').value = docDat.description;\n        document.getElementById('inDescShort').value = docDat.descriptionShort;\n        render();\n        if (docDat.public) {\n            hideEl(document.getElementById('btnAprove'));\n            hideEl(document.getElementById('btnPub'));\n        } else {\n            showEl(document.getElementById('btnAprove'));\n            if (docDat.pastDue) showEl(document.getElementById('btnPub'));\n        }\n        if (docDat.revised.includes(uid)) {\n            document.getElementById('btnAprove').innerHTML = '<i class=\"fas fa-check-square\"></i>';\n        } else {\n            document.getElementById('btnAprove').innerHTML = '<i class=\"far fa-check-square\"></i>';\n        }\n        document.getElementById('btnPrevCal').href = docDat.url;\n        document.getElementById('btnPrevMail').href = '/vista-email-calendario/' + docId;\n        document.getElementById('btnSrcCal').href = `https://in-the-sky.org/newscal.php?month=${urlSrch.get('id').substr(5, 6)}&year=${urlSrch.get('id').substr(0, 4)}&maxdiff=7&country=1484&reg1=3527646&reg2=8379372&town=3530597`;\n        document.getElementById('btnSrcCal2').href = `https://in-the-sky.org/newscal.php?month=${urlSrch.get('id').substr(5, 6)}&year=${urlSrch.get('id').substr(0, 4)}&maxdiff=7&country=1170&reg1=3688685&reg2=9609540&town=3688689`;\n        document.getElementById('btnSrcCal3').href = `https://in-the-sky.org/newscal.php?month=${urlSrch.get('id').substr(5, 6)}&year=${urlSrch.get('id').substr(0, 4)}&maxdiff=7&country=1724&reg1=3117732&reg2=6355233&town=3117735`;\n    }, err => console.log(err))\n\n    function descFrm() {\n        docDat.description = document.getElementById('inDesc').value.trim();\n        docDat.descriptionShort = document.getElementById('inDescShort').value.trim();\n        normSave();\n    }\n    document.getElementById(\"frmText\").addEventListener(\"submit\", function (event) {\n        event.preventDefault();\n        descFrm();\n    });\n\n    function addMed() {\n        let ref = store.ref('calendarMedia/' + docId + '/pic');\n        ref.put(newMedia).on('state_changed',\n            function progress(snap) {\n                setprog(document.getElementById('barChgImg'), (snap.bytesTransferred / snap.totalBytes) * 100);\n            },\n            function error(err) {\n                if (lang = \"es\") {\n                    alertTop(\"<strong>¡Ha ocurrido un error!</strong> \" + err.code, 0);\n                } else if (lang = \"en\") {\n                    alertTop(\"<strong>¡There has been an error!</strong> \" + err.code, 0);\n                }\n                console.log(err);\n                $('#mdlAddMed').modal('hide');\n            },\n            function complete() {\n                ref.getDownloadURL().then(medUrl => {\n                    docDat.picUrl = medUrl;\n                    normSave();\n                    resetChgImg(true);\n                    hideEl(document.getElementById(\"frmChgImg\"));\n                }).catch(err => { console.log(err) });\n            }\n        );\n    }\n    function addExtMed() {\n        docDat.picUrl = document.getElementById('inChgImgUrl').value;\n        normSave();\n        resetChgImg(true);\n        hideEl(document.getElementById(\"frmChgImg\"));\n    }\n    document.getElementById(\"frmChgImg\").addEventListener(\"submit\", function (event) {\n        event.preventDefault();\n        setprog(document.getElementById('barChgImg'), 0);\n        showEl(document.getElementById(\"barChgImgCont\"));\n        hideEl(document.getElementById(\"frmChgImg\"));\n        document.getElementById(\"btnCnfChgImg\").setAttribute('disabled', 'true');\n        document.getElementById(\"btnCanChgImg\").setAttribute('disabled', 'true');\n        if (newMedSrc == \"home\") addMed();\n        else addExtMed();\n    });\n}\n\ndocument.getElementById('inPicCapt').oninput = () => {\n    docDat.picCapt = document.getElementById('inPicCapt').value.trim();\n}\ndocument.getElementById('inPicAlt').oninput = () => {\n    docDat.picAlt = document.getElementById('inPicAlt').value.trim();\n}\ndocument.getElementById('inDesc').oninput = () => {\n    docDat.picDesc = document.getElementById('inDesc').value.trim();\n}\ndocument.getElementById('inDescShort').oninput = () => {\n    docDat.picDescShort = document.getElementById('inDescShort').value.trim();\n}\n\nlet savedInterval;\nfunction saveDoc() {\n    console.log('Saving...');\n\n    const promises = [];\n    langs.forEach(l => {\n        if (l != lang) {\n            let syncUpt = {\n                published: docDat.published,\n                finished: docDat.finished,\n                pastDue: docDat.pastDue,\n                public: docDat.public,\n                sentMail: docDat.sentMail,\n                revised: docDat.revised,\n                translations: docDat.translations,\n            }\n            syncUpt.translations[lang] = docDat.url;\n            promises.push(db.collection('cookies/langs/' + l).doc(docId).update(syncUpt));\n        }\n    })\n    return Promise.all(promises).then(() => {\n        return docRef.update(docDat);\n    });\n}\nfunction normSave() {\n    saveDoc().then(() => {\n        if (eventToShow) showEvent();//IMPORTANT\n        if (saved) clearInterval(savedInterval);\n        saved = true;\n        savedInterval = setInterval(() => {\n            let minutes = Math.floor((Date.now() - lastSave) / 60000);\n            if (minutes < 60) document.getElementById('tagLstSave').innerText = \"Guardado hace \" + minutes + \" minutos\";\n            else document.getElementById('tagLstSave').innerText = \"Guardado hace \" + Math.floor(minutes / 60) + \" horas\";\n        }, 300010);\n        document.getElementById('tagLstSave').innerText = \"Se han guardado los cambios\";\n        lastSave = Date.now();\n    }).catch(err => {\n        document.getElementById('tagLstSave').innerText = \"Error, no se han guardado todos los cambios: \" + err.code;\n        console.log(err);\n    });\n}\n\nfunction setprog(bar, n) {\n    n = Math.floor(n);\n    bar.setAttribute('aria-valuenow', n);\n    bar.style.width = n + '%';\n    bar.innerText = n + '%';\n}\n\nfunction showEvent() {\n    Object.keys(docDat.events).forEach(key => {\n        hideEl(document.getElementById(key));\n    });\n    document.getElementById('mdlEventInfoL').innerHTML = docDat.events[eventToShow].date;\n    showEl(document.getElementById(eventToShow));\n    enable(document.getElementById('btnPriorEve'));\n    enable(document.getElementById('btnNextEve'));\n}\ndocument.getElementById('btnPriorEve').onclick = () => {\n    let orderedKeys = Object.keys(docDat.events).slice().sort((a, b) => {\n        if (Number(a[0]) == Number(b[0])) {\n            if (a.substring(1, 4) == b.substring(1, 4)) {\n                return Number(a[4]) - Number(b[4]);\n            }\n            switch (a.substring(1, 4)) {\n                case \"sun\":\n                    return -1;\n                case \"mon\":\n                    if (b.substring(1, 4) == \"sun\") return 1;\n                    return -1;\n                case \"tue\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\") return 1\n                    return -1;\n                case \"wed\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\") return 1\n                    return -1;\n                case \"thu\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\") return 1\n                    return -1;\n                case \"fri\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\" || b.substring(1, 4) == \"thu\") return 1\n                    return -1;\n                case \"sat\":\n                    return 1;\n            }\n        }\n        return Number(a[0]) - Number(b[0]);\n    });\n    let n = orderedKeys.indexOf(eventToShow) - 1;\n    if (n >= 0) {\n        eventToShow = orderedKeys[n];\n        showEvent();\n    } else {\n        disable(document.getElementById('btnPriorEve'));\n    }\n};\ndocument.getElementById('btnNextEve').onclick = () => {\n    let orderedKeys = Object.keys(docDat.events).slice().sort((a, b) => {\n        if (Number(a[0]) == Number(b[0])) {\n            if (a.substring(1, 4) == b.substring(1, 4)) {\n                return Number(a[4]) - Number(b[4]);\n            }\n            switch (a.substring(1, 4)) {\n                case \"sun\":\n                    return -1;\n                case \"mon\":\n                    if (b.substring(1, 4) == \"sun\") return 1;\n                    return -1;\n                case \"tue\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\") return 1\n                    return -1;\n                case \"wed\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\") return 1\n                    return -1;\n                case \"thu\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\") return 1\n                    return -1;\n                case \"fri\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\" || b.substring(1, 4) == \"thu\") return 1\n                    return -1;\n                case \"sat\":\n                    return 1;\n            }\n        }\n        return Number(a[0]) - Number(b[0]);\n    });\n    let n = orderedKeys.indexOf(eventToShow) + 1;\n    if (n < orderedKeys.length) {\n        eventToShow = orderedKeys[n];\n        showEvent();\n    } else {\n        disable(document.getElementById('btnNextEve'));\n    }\n};\n\nfunction render() {\n    document.getElementById('weeksCont').innerHTML = \"\";\n    docDat.weeks.forEach((week, wIdx) => {\n        let weekRow = document.createElement('tr');\n        weekRow.style.height = '10rem';\n        document.getElementById('weeksCont').appendChild(weekRow);\n        for (let i = 0; i < 7; i++) {\n            let day = week[daysOfWeek[i]]\n            let dayCell = document.createElement('td');\n            classes(dayCell, \"p-0\");\n            weekRow.appendChild(dayCell);\n            if (day) {\n                let num = document.createElement('p');\n                classes(num, \"m-0 p-1\");\n                num.style.fontSize = 'x-large';\n                num.innerHTML = '<b>' + day.date + '</b>';\n                dayCell.appendChild(num);\n\n                let events = document.createElement('div');\n                classes(events, \"autoOverflow\");\n                events.style.maxHeight = '7rem';\n                day.events.forEach((event, idx) => {\n                    let btnEvent = document.createElement('button');\n                    btnEvent.setAttribute(\"data-toggle\", \"modal\");\n                    btnEvent.setAttribute(\"data-target\", \"#mdlEventInfo\");\n                    classes(btnEvent, \"btn text-left p-1 mb-1 w-100\");\n                    btnEvent.style.backgroundColor = \"#c3e6cb\";\n                    btnEvent.style.borderColor = \"#8fd19e\";\n                    btnEvent.innerHTML = '<small>' + event.name + '</small>';\n                    btnEvent.onclick = () => {\n                        eventToShow = wIdx + daysOfWeek[i] + idx;\n                        showEvent();\n                    }\n                    events.appendChild(btnEvent);\n                });\n                let btnPlusEvent = document.createElement('button');\n                classes(btnPlusEvent, \"btn btn-scckie btn-block btn-sm\");\n                btnPlusEvent.innerHTML = '<i class=\"fas fa-plus\"></i>';\n                btnPlusEvent.onclick = () => {\n                    docDat.events[wIdx + daysOfWeek[i] + day.events.length] = {\n                        date: longDay[i] + \" \" + day.date + \" de \" + fullMonth(docId % 100),\n                        name: \"Evento sin nombre\",\n                        description: \"Sin descripción\",\n                        visibilidad: \"Visible a simple vista\",\n                        horario: [\"Ciudad de México:\", \"Bogotá:\", \"Madrid:\"]\n                    };\n                    day.events.push({\n                        name: \"Evento sin nombre\"\n                    });\n                    normSave();\n                }\n                events.appendChild(btnPlusEvent);\n                dayCell.appendChild(events);\n            }\n        }\n    });\n    document.getElementById('eventInfoCont').innerHTML = \"\";\n    for (const [key, event] of Object.entries(docDat.events)) {\n        let changed = false;\n        let form = document.createElement('div');\n        form.id = key;\n        classes(form, \"d-none overflow-auto\");\n        let bod = document.createElement('div');\n        classes(bod, \"modal-body\");\n        form.appendChild(bod);\n\n        let fsec = document.createElement('div');\n        classes(fsec, \"d-none\");\n        bod.appendChild(fsec);\n        let fg0 = document.createElement('div');\n        classes(fg0, \"form-group\");\n        fsec.appendChild(fg0);\n        fg0.innerHTML = '<label>Nombre del evento</label>';\n        let in0 = document.createElement('input');\n        in0.id = \"inEveTitle\" + key;\n        in0.setAttribute(\"type\", \"text\");\n        classes(in0, \"form-control\");\n        fg0.appendChild(in0);\n        let fg1 = document.createElement('div');\n        classes(fg1, \"form-group\");\n        fsec.appendChild(fg1);\n        fg1.innerHTML = '<label>Descripción</label>';\n        let in1 = document.createElement('textarea');\n        classes(in1, \"form-control\");\n        in1.id = \"inEveDesc\" + key;\n        in1.setAttribute(\"rows\", \"3\");\n        fg1.appendChild(in1);\n        let fg2 = document.createElement('div');\n        classes(fg2, \"form-group\");\n        fsec.appendChild(fg2);\n        fg2.innerHTML = '<label>Visiblidad</label>';\n        let in2 = document.createElement('select');\n        in2.id = \"inVis\" + key;\n        classes(in2, \"form-control\");\n        let visOpts = [\"Visible a simple vista\", \"Visible con binoculares\", \"Visible con un telescopio pequeño\", \"Visible con un telescopio de 4 pulgadas\", \"Visible con un telescopio grande\", \"No observable\"]\n        visOpts.forEach((itm, idx) => {\n            let opt = document.createElement('option');\n            opt.value = idx;\n            opt.innerHTML = itm;\n            if (itm == event.visibilidad) opt.setAttribute('selected', \"true\");\n            in2.appendChild(opt);\n        });\n        fg2.appendChild(in2);\n        let fg3 = document.createElement('div');\n        classes(fg3, \"form-group\");\n        fsec.appendChild(fg3);\n        fg3.innerHTML = '<label>Horario</label>';\n        let in3 = document.createElement('textarea');\n        classes(in3, \"form-control\");\n        in3.id = \"inTime\" + key;\n        in3.setAttribute(\"rows\", \"4\");\n        fg3.appendChild(in3);\n        if (in2.value == 5) hideEl(fg3);\n        else showEl(fg3);\n        in0.oninput = () => {\n            enable(reverBtn);\n            changed = true;\n        };\n        in1.oninput = () => {\n            enable(reverBtn);\n            changed = true;\n        };\n        in2.oninput = () => {\n            enable(reverBtn);\n            changed = true;\n            if (in2.value == 5) hideEl(fg3);\n            else showEl(fg3);\n        };\n        in3.oninput = () => {\n            enable(reverBtn);\n            changed = true;\n        };\n\n        let tsec = document.createElement('div');\n        bod.appendChild(tsec);\n        let eveTit = document.createElement('h3');\n        eveTit.innerHTML = event.name;\n        tsec.appendChild(eveTit);\n        let eveDesc = document.createElement('p');\n        eveDesc.innerHTML = event.description;\n        tsec.appendChild(eveDesc);\n        let eveVis = document.createElement('p');\n        eveVis.innerHTML = \"Visibilidad: \" + event.visibilidad;\n        tsec.appendChild(eveVis);\n        let eveTime = document.createElement('p');\n        classes(eveTime, \"mb-0\");\n        eveTime.innerHTML = \"Horario: \";\n        tsec.appendChild(eveTime);\n        let eveTimeLst = document.createElement('ul');\n        tsec.appendChild(eveTimeLst);\n        event.horario.forEach(time => {\n            let li = document.createElement('li');\n            li.innerHTML = time;\n            eveTimeLst.appendChild(li);\n        });\n        if (event.visibilidad == \"No observable\") {\n            hideEl(eveTime);\n            hideEl(eveTimeLst);\n        }\n        else {\n            showEl(eveTime);\n            showEl(eveTimeLst);\n        }\n\n\n        let foot = document.createElement('div');\n        classes(foot, \"modal-footer\");\n        form.appendChild(foot);\n\n        let delBtn = document.createElement('button');\n        classes(delBtn, \"btn btn-danger mr-auto\")\n        delBtn.setAttribute(\"type\", \"button\");\n        delBtn.innerText = \"Borrar\";\n        delBtn.onclick = () => {\n            for (let i = Number(key.substr(4)) + 1; i < docDat.weeks[Number(key[0])][key.substr(1, 3)].events.length; i++) {\n                docDat.events[key.substr(0, 4) + (i - 1)] = docDat.events[key.substr(0, 4) + i]\n            }\n            delete docDat.events[key.substr(0, 4) + (docDat.weeks[Number(key[0])][key.substr(1, 3)].events.length - 1)];\n            docDat.weeks[Number(key[0])][key.substr(1, 3)].events.splice(Number(key.substr(4)), 1);\n            $('#mdlEventInfo').modal('hide');\n            eventToShow = null;\n            normSave();\n        };\n        foot.appendChild(delBtn);\n        let editBtn = document.createElement('button');\n        classes(editBtn, \"btn btn-info\");\n        editBtn.setAttribute(\"type\", \"button\");\n        editBtn.innerText = \"Editar\";\n        editBtn.onclick = () => {\n            in0.value = event.name;\n            in1.innerHTML = event.description;\n            in2.value = visOpts.indexOf(event.visibilidad);\n            if (in2.value == 5) hideEl(fg3);\n            else showEl(fg3);\n            in3.innerHTML = \"\";\n            event.horario.forEach(time => {\n                in3.innerHTML += time + \"\\n\";\n            });\n            hideEl(tsec);\n            showEl(fsec);\n            showEl(reverBtn);\n            showEl(saveBtn);\n            enable(saveBtn);\n            hideEl(editBtn);\n        };\n        foot.appendChild(editBtn);\n        let reverBtn = document.createElement('button');\n        classes(reverBtn, \"btn btn-secondary mr-1 d-none\");\n        reverBtn.setAttribute(\"type\", \"button\");\n        disable(reverBtn);\n        reverBtn.innerText = \"Revertir\";\n        reverBtn.onclick = () => {\n            changed = false;\n            disable(reverBtn);\n            in0.value = event.name;\n            in1.innerHTML = event.description;\n            in2.value = visOpts.indexOf(event.visibilidad);\n            if (in2.value == 5) hideEl(fg3);\n            else showEl(fg3);\n            in3.innerHTML = \"\";\n            event.horario.forEach(time => {\n                in3.innerHTML += time.trim() + \"\\n\";\n            });\n        };\n        foot.appendChild(reverBtn);\n        let saveBtn = document.createElement('button');\n        classes(saveBtn, \"btn btn-scckie d-none\");\n        saveBtn.setAttribute(\"type\", \"button\");\n        disable(saveBtn);\n        saveBtn.innerText = \"Guardar\";\n        saveBtn.onclick = () => {\n            disable(reverBtn);\n            disable(saveBtn);\n            if (changed) {\n                docDat.weeks[Number(key[0])][key.substr(1, 3)].events[key[4]].name = event.name = in0.value;\n                event.description = in1.value.trim();\n                event.visibilidad = visOpts[in2.value];\n                event.horario = [];\n                in3.value.trim().split('\\n').forEach(time => {\n                    if (time != \"\" && time != \" \") event.horario.push(time);\n                });\n                normSave();\n            } else {\n                hideEl(fsec);\n                showEl(tsec);\n                hideEl(reverBtn);\n                hideEl(saveBtn);\n                showEl(editBtn);\n            }\n        };\n        foot.appendChild(saveBtn);\n\n        document.getElementById('eventInfoCont').appendChild(form);\n    }\n}\n\n\nfunction resetChgImg(uncheck) {\n    document.getElementById('prevMed').src = docDat.picUrl;\n    if (uncheck) {\n        document.getElementById('inMedSrc0').checked = false;\n        document.getElementById('inMedSrc1').checked = false;\n    }\n    document.getElementById('inChgImg').value = \"\";\n    document.getElementById('inChgImgUrl').value = \"\";\n    document.getElementById('inChgImg').removeAttribute('required');\n    document.getElementById('inChgImgUrl').removeAttribute('required');\n    hideEl(document.getElementById(\"barChgImgCont\"));\n    hideEl(document.getElementById(\"inChgImgFileCont\"));\n    hideEl(document.getElementById(\"inChgImgUrlCont\"));\n    document.getElementById(\"btnCnfChgImg\").removeAttribute('disabled');\n    document.getElementById(\"btnCanChgImg\").removeAttribute('disabled');\n}\ndocument.getElementById('btnChgImg').onclick = () => {\n    resetChgImg(true);\n    toggleEl(document.getElementById(\"frmChgImg\"));\n};\ndocument.getElementById('inChgImg').addEventListener('change', e => {\n    newMedia = e.target.files[0];\n    function prevMed() {\n        var read = new FileReader();\n        read.readAsDataURL(newMedia);\n        read.onload = function (e2) {\n            document.getElementById(\"prevMed\").src = e2.target.result;\n        };\n    };\n    newMedia.name = ultraClean(newMedia.name, '');\n    document.getElementById('inChgImgL').innerHTML = newMedia.name;\n    prevMed(newMedia);\n});\ndocument.getElementById('inChgImgUrl').onchange = function () {\n    document.getElementById(\"prevMed\").src = document.getElementById('inChgImgUrl').value;\n};\ndocument.getElementById('inMedSrc0').onclick = function () {\n    newMedSrc = \"home\";\n    resetChgImg(false);\n    document.getElementById('inChgImg').setAttribute('required', 'true');\n    showEl(document.getElementById(\"inChgImgFileCont\"));\n}\ndocument.getElementById('inMedSrc1').onclick = function () {\n    newMedSrc = \"out\";\n    resetChgImg(false);\n    document.getElementById('inChgImgUrl').setAttribute('required', 'true');\n    showEl(document.getElementById(\"inChgImgUrlCont\"));\n}\n\ndocument.getElementById('btnPrevCal').onclick = function () {\n    docDat.timePrev = new firebase.firestore.Timestamp.fromMillis((new Date(Date.now())).getTime() + 900000);\n    normSave();\n};\ndocument.getElementById('btnPrevMail').onclick = function () {\n    docDat.timePrev = new firebase.firestore.Timestamp.fromMillis((new Date(Date.now())).getTime() + 900000);\n    normSave();\n};\n\nfunction validateRevision() {\n    let revLangs = 0;\n    langs.forEach(l => {\n        let rev = docDat.revised[l] ? docDat.revised[l].length : 0;\n        if (docDat.revised[l] && !docDat.revised[l].includes(uid)) rev++;\n        if (rev >= 2) revLangs++;\n    });\n    return revLangs == langs.length;\n}\n\ndocument.getElementById('btnAprove').onclick = function () {\n    if (docDat.revised[lang] && docDat.revised[lang].includes(uid)) {\n        docDat.revised[lang].splice(docDat.revised[lang].indexOf(uid), 1);\n        document.getElementById('btnAprove').innerHTML = '<i class=\"far fa-check-square\"></i>';\n    } else {\n        if (!docDat.revised[lang]) docDat.revised[lang] = [];\n        docDat.revised[lang].push(uid);\n        document.getElementById('btnAprove').innerHTML = '<i class=\"fas fa-check-square\"></i>';\n    }\n    if (validateRevision()) {\n        docDat.finished = true;\n        newCal();\n    } else {\n        docDat.finished = false;\n    }\n    normSave();\n};\n\nfunction newCal() {\n    let nextCalID;\n    rtDb.ref('nextCal').transaction(nCal => {\n        if (nCal) {\n            nextCalID = nCal;\n            nCal++;\n            if (nCal % 100 == 13) {\n                nCal -= 12;\n                nCal += 100;\n            }\n        }\n        return nCal;\n    }, (error) => {\n        if (error) {\n            console.log(error);\n        } else {\n            let date = new Date((nextCalID - nextCalID % 100) / 100 + ' ' + nextCalID % 100 + ' ' + '00:00');\n            let weeks = [];\n            let days;\n            if (date.getMonth() == 1) {\n                if (date.getFullYear() % 4 == 0) {\n                    days = 29;\n                } else {\n                    days = 28;\n                }\n            } else if (date.getMonth() % 2 == 0) {\n                if (date.getMonth() <= 6) days = 31;\n                else days = 30;\n            } else {\n                if (date.getMonth() <= 6) days = 30;\n                else days = 31;\n            }\n            let bDay = date.getDay();\n            for (let i = 1; i <= days; i = i) {\n                let week = {};\n                for (let j = bDay; j < daysOfWeek.length; j++) {\n                    if (i > days) break;\n                    week[daysOfWeek[j]] = {\n                        date: i,\n                        events: []\n                    }\n                    i++;\n                }\n                weeks.push(week);\n                bDay = 0;\n            }\n            const promises = [];\n            langs.forEach(l => {\n                if (l != lang) {\n                    let newC = {\n                        events: {},\n                        published: firebase.firestore.Timestamp.fromDate(date),\n                        description: \"\",\n                        descriptionShort: \"\",\n                        finished: false,\n                        pastDue: false,\n                        picUrl: \"\",\n                        picAlt: \"\",\n                        picCapt: \"\",\n                        public: false,\n                        sentMail: false,\n                        revised: {},\n                        title: \"\",\n                        url: \"\",\n                        nextCal: \"\",\n                        priorCal: \"\",\n                        weeks: weeks,\n                        translations: {}\n                    }\n\n                    let intId = parseInt(nextCalID);\n                    let year = (intId - intId % 100) / 100;\n                    let nYear = (intId - intId % 100) / 100;\n                    let pYear = (intId - intId % 100) / 100;\n                    if (intId % 100 == 12) nYear++;\n                    if (intId % 100 == 1) pYear--;\n                    let month = fullMonth(intId % 100);\n                    let nMonth = fullMonth(intId % 100 + 1).toLowerCase();\n                    let pMonth = fullMonth(intId % 100 - 1).toLowerCase();\n                    let calsText = \"\";\n                    switch (l) {\n                        case \"es\":\n                            calsText = \"calendario-astronomico\";\n                            newC.title = \"Calendario Astronómico de \" + month + \" \" + year;\n                            break;\n                        case \"en\":\n                            calsText = \"astronomic-calendar\";\n                            newC.title = \"Astronomic Calendar of \" + month + \" \" + year;\n                            break;\n                    }\n                    newC.url = \"https://sciencecookies.net/\" + calsText + \"/\" + year + \"/\" + month.toLowerCase() + \"/\";\n                    newC.nextCal = \"https://sciencecookies.net/\" + calsText + \"/\" + nYear + \"/\" + nMonth + \"/\";\n                    newC.priorCal = \"https://sciencecookies.net/\" + calsText + \"/\" + pYear + \"/\" + pMonth + \"/\";\n\n                    promises.push(db.collection('calendars/langs/' + l).doc(Math.abs(nextCalID).toString()).set(newC));\n                }\n            })\n            return Promise.all(promises).then(() => {\n                console.log('exito');\n            }).catch(err => console.log(err));\n        }\n    });\n}\n\n$('#mdlPublish').on('show.bs.modal', e => {\n    if (validateRevision()) {\n        showEl(document.getElementById('btnCnfPublish'));\n        document.getElementById('mdlPublishTxt').innerText = \"El calendario está listo para publicar\";\n    } else {\n        hideEl(document.getElementById('btnCnfPublish'));\n        document.getElementById('mdlPublishTxt').innerText = \"Para publicar es necesario que lo hayan aprovado al menos dos personas.\";\n    }\n});\n\ndocument.getElementById('btnCnfPublish').onclick = function () {\n    if (docDat.public) return;\n    setprog(document.getElementById('barPublish'), 0);\n    showEl(document.getElementById('barPublishCont'));\n\n    docDat.public = true;\n    setprog(document.getElementById('barPublish'), 25);\n\n    saveDoc().then(() => {\n        setprog(document.getElementById('barPublish'), 58);\n        admin.database().ref('calendarios/' + docId).set({\n            pop: 0\n        }, err => {\n            if (err) {\n                if (lang = \"es\") {\n                    alertTop(\"<strong>¡Ha ocurrido un error!</strong> \" + err.code, 0);\n                } else if (lang = \"en\") {\n                    alertTop(\"<strong>¡There has been an error!</strong> \" + err.code, 0);\n                }\n                console.log(err);\n            } else {\n                setprog(document.getElementById('barPublish'), 100);\n                classes(document.getElementById('barPublish'), 'bg-success');\n                if (lang = \"es\") {\n                    alertTop(\"Publicado correctamente\", 1);\n                } else if (lang = \"en\") {\n                    alertTop(\"Published successfully\", 1);\n                }\n                setTimeout(function () {\n                    window.open(docDat.url, '_blank').focus();\n                }, 2500);\n                $('#mdlPublish').modal('hide');\n                console.log('Published ' + docId + ' calendar');\n                return null;\n            }\n        });\n    }).catch(err => {\n        if (lang = \"es\") {\n            alertTop(\"<strong>¡Ha ocurrido un error!</strong> \" + err.code, 0);\n        } else if (lang = \"en\") {\n            alertTop(\"<strong>¡There has been an error!</strong> \" + err.code, 0);\n        }\n        console.log(err);\n    });\n};"]}