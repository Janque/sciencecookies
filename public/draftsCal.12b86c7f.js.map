{"version":3,"sources":["js/draftsCal.js"],"names":["window","loaded","initSrch","previewLim","nxtp","paglast","page","allChk","stAf","undefined","srchRef","calendarsFSRef","orderBy","startAfter","limit","shwSrch","document","getElementById","innerHTML","get","then","snap","docs","forEach","doc","idx","dat","data","col","createElement","classes","card","public","h","row","col0","badge","innerText","appendChild","col1","drp","btndrp","setAttribute","onclick","id","classList","contains","$","dropdown","setTimeout","drpmenu","drpitm0","location","href","drpitm1","open","focus","drpitm2","url","a","img","src","picUrl","alt","cbody","title","description","push","length","splice","remove","removeAttribute","catch","err","console","log","reSrch","np","scrollIntoView"],"mappings":"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","file":"draftsCal.12b86c7f.js","sourceRoot":"../src","sourcesContent":["window.loaded = function loaded() {\n    initSrch(false);\n}\n\nconst previewLim = 21;\n//Get search params\nvar nxtp = false, paglast = [null], page = 1;\nvar allChk = false;\nfunction initSrch(stAf) {\n    if (page > 1 && stAf && paglast[page - 1] != null && paglast[page - 1] != undefined) {\n        srchRef = calendarsFSRef.orderBy('published', 'desc').startAfter(paglast[page - 1]).limit(previewLim);\n    } else {\n        srchRef = calendarsFSRef.orderBy('published', 'desc').limit(previewLim);\n    }\n    shwSrch();\n}\nfunction shwSrch() {\n    document.getElementById('crdContainer').innerHTML = \"\";\n    srchRef.get().then(snap => {\n        let docs = snap.docs;\n        nxtp = false;\n        docs.forEach((doc, idx) => {\n            let dat = doc.data();\n\n            let col = document.createElement('col');\n            classes(col, 'col');\n            classes(col, 'mb-4');\n\n            let card = document.createElement('div');\n            classes(card, \"card text-dark bg-light h-100 cardBorder\");\n            if (dat.public) {\n                classes(card, 'border-success');\n            } else {\n                classes(card, 'border-secondary');\n            }\n\n            let h = document.createElement('div');\n            classes(h, \"card-header bg-light m-0 py-0 text-right\")\n            let row = document.createElement('div');\n            classes(row, 'row');\n            classes(row, 'justify-content-between');\n            if (!dat.public) {\n                let col0 = document.createElement('div');\n                classes(col0, 'col-auto');\n                classes(col0, 'p-0');\n                let badge = document.createElement('span');\n                classes(badge, 'badge');\n                classes(badge, 'badge-warning');\n                badge.innerText = 'Pendiente';\n                col0.appendChild(badge);\n                row.appendChild(col0);\n            }\n            let col1 = document.createElement('div');\n            classes(col1, 'col-auto');\n            classes(col1, 'p-0');\n            classes(col1, 'ml-auto');\n            let drp = document.createElement('div');\n            classes(drp, 'dropdown');\n            let btndrp = document.createElement('button');\n            classes(btndrp, 'btn');\n            classes(btndrp, 'btn-light');\n            btndrp.setAttribute('type', 'button');\n            btndrp.setAttribute('data-toogle', 'dropdown');\n            btndrp.setAttribute('aria-haspopup', \"true\");\n            btndrp.setAttribute('aria-expanded', \"false\");\n            btndrp.innerHTML = '<i class=\"fas fa-ellipsis-h\"></i>';\n            btndrp.onclick = function () {\n                if (document.getElementById(\"drpMenu\" + doc.id).classList.contains('show')) {\n                    $(\"#drpMenu\" + doc.id).dropdown('hide');\n                } else {\n                    $(\"#drpMenu\" + doc.id).dropdown('show');\n                    setTimeout(function () {\n                        $(\"#drpMenu\" + doc.id).dropdown('hide');\n                    }, 5000);\n                }\n            };\n            drp.appendChild(btndrp);\n            let drpmenu = document.createElement('div');\n            classes(drpmenu, 'dropdown-menu');\n            classes(drpmenu, 'dropdown-menu-right');\n            drpmenu.setAttribute('id', \"drpMenu\" + doc.id);\n            let drpitm0 = document.createElement('button');\n            classes(drpitm0, 'dropdown-item');\n            drpitm0.onclick = function () {\n                window.location.href = '../editar-calendario?id=' + doc.id;\n            };\n            drpitm0.innerHTML = 'Editar <i class=\"fas fa-edit\"></i>';\n            drpmenu.appendChild(drpitm0);\n            let drpitm1 = document.createElement('button');\n            classes(drpitm1, 'dropdown-item');\n            drpitm1.onclick = function () {\n                window.open('../vista-email-calendario/' + doc.id, '_blank').focus();\n            };\n            drpitm1.innerHTML = 'Vista correo <i class=\"fas fa-envelope\"></i>';\n            drpmenu.appendChild(drpitm1);\n            let drpitm2 = document.createElement('button');\n            if (dat.public) {\n                classes(drpitm2, 'dropdown-item');\n                drpitm2.onclick = function () {\n                    window.open(dat.url, '_blank').focus();\n                };\n                drpitm2.innerHTML = 'Ver calendario <i class=\"fas fa-eye\"></i>';\n                drpmenu.appendChild(drpitm2);\n            }\n            drp.appendChild(drpmenu);\n            col1.appendChild(drp);\n            row.appendChild(col1);\n            h.appendChild(row);\n            card.appendChild(h);\n\n            let a = document.createElement('a');\n            a.href = '../editar-calendario?id=' + doc.id;\n            classes(a, 'text-decoration-none');\n            classes(a, 'text-dark');\n            let img = document.createElement('img');\n            img.src = dat.picUrl;\n            classes(img, 'card-img-top');\n            img.alt = 'No hay imagen'\n            a.appendChild(img);\n            let cbody = document.createElement('div');\n            classes(cbody, 'card-body');\n            cbody.innerHTML = '<h3 class=\"card-title\">' + dat.title + '</h3>\\n<p class=\"card-text\">' + dat.description + '</p>\\n'\n            a.appendChild(cbody);\n            card.appendChild(a);\n\n            col.appendChild(card);\n            document.getElementById('crdContainer').appendChild(col);\n            if (idx == previewLim - 1) {\n                if (paglast[page] == undefined || paglast[page] == null) {\n                    paglast.push(docs[docs.length - 1]);\n                } else if (paglast[page] != docs[docs.length - 1]) {\n                    paglast.splice(page, 1, docs[docs.length - 1]);\n                }\n                nxtp = true;\n                document.getElementById(\"pgNavT\").classList.remove('d-none');\n                document.getElementById(\"pgNavB\").classList.remove('d-none');\n            }\n        });\n        if (!nxtp) {\n            document.getElementById(\"pgTNxt\").setAttribute('disabled', 'true');\n            document.getElementById(\"pgBNxt\").setAttribute('disabled', 'true');\n        } else {\n            document.getElementById(\"pgTNxt\").removeAttribute('disabled');\n            document.getElementById(\"pgBNxt\").removeAttribute('disabled');\n        }\n        if (page == 1) {\n            document.getElementById(\"pgTPrv\").setAttribute('disabled', 'true');\n            document.getElementById(\"pgBPrv\").setAttribute('disabled', 'true');\n        } else {\n            document.getElementById(\"pgTPrv\").removeAttribute('disabled');\n            document.getElementById(\"pgBPrv\").removeAttribute('disabled');\n        }\n    }).catch(err => { console.log(err) });\n}\n\ndocument.getElementById(\"pgTPrv\").onclick = function () { reSrch(-1); };\ndocument.getElementById(\"pgBPrv\").onclick = function () { reSrch(-1); };\ndocument.getElementById(\"pgTNxt\").onclick = function () { reSrch(1); };\ndocument.getElementById(\"pgBNxt\").onclick = function () { reSrch(1); };\nfunction reSrch(np) {\n    if (page < 1 && np == -1) return;\n    if (!nxtp && np == 1) return;\n    page += np;\n    document.getElementById('disPgT').innerText = page;\n    document.getElementById('disPgB').innerText = page;\n    initSrch(true);\n    document.getElementById(\"cookCnt\").scrollIntoView();\n}"]}