{"mappings":"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","sources":["src/js/editCal.js"],"sourcesContent":["var store = firebase.storage();\nvar rtDb = firebase.database();\n\nlet docDat, docId, docRef, calConfig;\nlet lastSave = Date.now(), saved = false;\n\nlet newMedia = null;\nlet newMedSrc = null;\n\nlet eventToShow = null;\n\nasync function translateSimple(text, from, target) {\n    let translate = firebase.app().functions('us-east1').httpsCallable('translations-translateSimple');\n    let res = await translate({\n        text: text,\n        from: from,\n        target: target\n    });\n    return res.data;\n}\n\nconst daysOfWeek = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat']\nconst longDay = {\n    es: ['Domingo', 'Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sabado'],\n    en: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']\n}\nfunction fullMonth(n, l) {\n    if (l == \"es\") {\n        switch (n) {\n            case 1:\n                return \"Enero\";\n            case 2:\n                return \"Febrero\";\n            case 3:\n                return \"Marzo\";\n            case 4:\n                return \"Abril\";\n            case 5:\n                return \"Mayo\";\n            case 6:\n                return \"Junio\";\n            case 7:\n                return \"Julio\";\n            case 8:\n                return \"Agosto\";\n            case 9:\n                return \"Septiembre\";\n            case 10:\n                return \"Octubre\";\n            case 11:\n                return \"Noviembre\";\n            case 12:\n                return \"Diciembre\";\n            case 0:\n                return \"Diciembre\";\n            case 13:\n                return \"Enero\";\n        }\n    } else if (l == \"en\") {\n        switch (n) {\n            case 1:\n                return \"January\";\n            case 2:\n                return \"February\";\n            case 3:\n                return \"March\";\n            case 4:\n                return \"April\";\n            case 5:\n                return \"May\";\n            case 6:\n                return \"June\";\n            case 7:\n                return \"July\";\n            case 8:\n                return \"August\";\n            case 9:\n                return \"September\";\n            case 10:\n                return \"October\";\n            case 11:\n                return \"November\";\n            case 12:\n                return \"December\";\n            case 0:\n                return \"December\";\n            case 13:\n                return \"January\";\n        }\n    }\n}\n\nwindow.loaded = function loaded() {\n    db.collection('config').doc('calTypes').get().then(doc => {\n        calConfig = doc.data();\n        docRef = calendarsFSRef.doc(urlSrch.get('id'));\n        calendarsFSRef.doc(urlSrch.get('id')).onSnapshot(doc => {\n            if (!doc.exists) {\n                window.location.href = '../404';\n                return;\n            }\n            docDat = doc.data();\n            docId = doc.id;\n            document.getElementById('title').innerHTML = docDat.title;\n            document.getElementById('prevMed').src = docDat.picUrl;\n            document.getElementById('inPicCapt').value = docDat.picCapt;\n            document.getElementById('inPicAlt').value = docDat.picAlt;\n            document.getElementById('inDesc').value = docDat.description;\n            document.getElementById('inDescShort').value = docDat.descriptionShort;\n            render();\n            if (docDat.public) {\n                hideEl(document.getElementById('btnAprove'));\n                hideEl(document.getElementById('btnPub'));\n            } else {\n                showEl(document.getElementById('btnAprove'));\n                if (docDat.pastDue) showEl(document.getElementById('btnPub'));\n            }\n            if (docDat.revised[lang] && docDat.revised[lang].includes(uid)) {\n                document.getElementById('btnAprove').innerHTML = '<i class=\"fas fa-check-square\"></i>';\n            } else {\n                document.getElementById('btnAprove').innerHTML = '<i class=\"far fa-check-square\"></i>';\n            }\n            document.getElementById('btnPrevCal').href = docDat.url;\n            document.getElementById('btnPrevMail').href = '/vista-email-calendario/' + docId;\n            document.getElementById('btnSrcCal').href = `https://in-the-sky.org/newscal.php?month=${urlSrch.get('id').substr(5, 6)}&year=${urlSrch.get('id').substr(0, 4)}&maxdiff=7&country=1484&reg1=3527646&reg2=8379372&town=3530597`;\n            document.getElementById('btnSrcCal2').href = `https://in-the-sky.org/newscal.php?month=${urlSrch.get('id').substr(5, 6)}&year=${urlSrch.get('id').substr(0, 4)}&maxdiff=7&country=1170&reg1=3688685&reg2=9609540&town=3688689`;\n            document.getElementById('btnSrcCal3').href = `https://in-the-sky.org/newscal.php?month=${urlSrch.get('id').substr(5, 6)}&year=${urlSrch.get('id').substr(0, 4)}&maxdiff=7&country=1724&reg1=3117732&reg2=6355233&town=3117735`;\n        }, err => console.log(err))\n    }).catch(err => console.log(err));\n\n    function descFrm() {\n        docDat.description = document.getElementById('inDesc').value.trim();\n        docDat.descriptionShort = document.getElementById('inDescShort').value.trim();\n        normSave();\n    }\n    document.getElementById(\"frmText\").addEventListener(\"submit\", function (event) {\n        event.preventDefault();\n        descFrm();\n    });\n    document.getElementById('btnFileTrans').onclick = function () {\n        let ori = document.getElementById('selFileTrans').value\n        db.collection('calendars/langs/' + ori).doc(docId).get().then(async function (doc) {\n            docDat.picCapt = document.getElementById('inPicCapt').value = await translateSimple(doc.data().picCapt, ori, lang);\n            docDat.picAlt = document.getElementById('inPicAlt').value = await translateSimple(doc.data().picAlt, ori, lang);\n            docDat.description = document.getElementById('inDesc').value = await translateSimple(doc.data().description, ori, lang);\n            docDat.descriptionShort = document.getElementById('inDescShort').value = await translateSimple(doc.data().descriptionShort, ori, lang);\n            descFrm();\n        }).catch(err => console.log(err));\n    }\n\n    function translateFrm() {\n        let translate = firebase.app().functions('us-east1').httpsCallable('translations-translateFullCalendar');\n        return translate({\n            docId: docId,\n            from: document.getElementById('inTransFrom').value,\n            target: lang\n        });\n    }\n    document.getElementById(\"frmTranslate\").addEventListener(\"submit\", function (event) {\n        event.preventDefault();\n        classes(document.getElementById('btnCnfTranslate'), \"disabled\")\n        classes(document.getElementById('btnCanTranslate0'), \"disabled\")\n        classes(document.getElementById('btnCanTranslate1'), \"disabled\")\n        setprog('barTranslate', 0);\n        showEl(document.getElementById('barTranslateCont'));\n        runprog('barTranslate', 0, 73);\n        translateFrm().then(res => {\n            runprog('barTranslate', 73, 90);\n            if (res) {\n                setprog('barTranslate', 100);\n                $('#mdlTranslate').modal('hide');\n                document.getElementById('btnCnfTranslate').classList.remove(\"disabled\");\n                document.getElementById('btnCanTranslate0').classList.remove(\"disabled\");\n                document.getElementById('btnCanTranslate1').classList.remove(\"disabled\");\n                hideEl(document.getElementById('barTranslateCont'))\n            } else {\n                if (lang == \"es\") {\n                    alertTop(\"<strong>¡Ha ocurrido un error!</strong>\", 0);\n                } else if (lang == \"en\") {\n                    alertTop(\"<strong>¡There has been an error!</strong>\", 0);\n                }\n                console.log('err');\n            }\n        });\n    });\n\n    function addMed() {\n        let ref = store.ref('calendarMedia/' + docId + '/pic');\n        ref.put(newMedia).on('state_changed',\n            function progress(snap) {\n                setprog('barChgImg', (snap.bytesTransferred / snap.totalBytes) * 100);\n            },\n            function error(err) {\n                if (lang == \"es\") {\n                    alertTop(\"<strong>¡Ha ocurrido un error!</strong> \" + err.code, 0);\n                } else if (lang == \"en\") {\n                    alertTop(\"<strong>¡There has been an error!</strong> \" + err.code, 0);\n                }\n                console.log(err);\n                $('#mdlAddMed').modal('hide');\n            },\n            function complete() {\n                ref.getDownloadURL().then(medUrl => {\n                    docDat.picUrl = medUrl;\n                    normSave();\n                    resetChgImg(true);\n                    hideEl(document.getElementById(\"frmChgImg\"));\n                }).catch(err => { console.log(err) });\n            }\n        );\n    }\n    function addExtMed() {\n        docDat.picUrl = document.getElementById('inChgImgUrl').value;\n        normSave();\n        resetChgImg(true);\n        hideEl(document.getElementById(\"frmChgImg\"));\n    }\n    document.getElementById(\"frmChgImg\").addEventListener(\"submit\", function (event) {\n        event.preventDefault();\n        setprog('barChgImg', 0);\n        showEl(document.getElementById(\"barChgImgCont\"));\n        hideEl(document.getElementById(\"frmChgImg\"));\n        document.getElementById(\"btnCnfChgImg\").setAttribute('disabled', 'true');\n        document.getElementById(\"btnCanChgImg\").setAttribute('disabled', 'true');\n        if (newMedSrc == \"home\") addMed();\n        else addExtMed();\n    });\n}\n\ndocument.getElementById('inPicCapt').onchange = () => {\n    docDat.picCapt = document.getElementById('inPicCapt').value.trim();\n}\ndocument.getElementById('inPicAlt').onchange = () => {\n    docDat.picAlt = document.getElementById('inPicAlt').value.trim();\n}\ndocument.getElementById('inDesc').onchange = () => {\n    docDat.picDesc = document.getElementById('inDesc').value.trim();\n}\ndocument.getElementById('inDescShort').onchange = () => {\n    docDat.picDescShort = document.getElementById('inDescShort').value.trim();\n}\n\nlet savedInterval;\nfunction saveDoc() {\n    console.log('Saving...');\n\n    const promises = [];\n    langs.forEach(l => {\n        if (l != lang) {\n            let syncUpt = {\n                published: docDat.published,\n                finished: docDat.finished,\n                pastDue: docDat.pastDue,\n                public: docDat.public,\n                sentMail: docDat.sentMail,\n                revised: docDat.revised,\n                translations: docDat.translations,\n                timePrev: docDat.timePrev | null,\n            }\n            syncUpt.translations[lang] = docDat.url;\n            promises.push(db.collection('calendars/langs/' + l).doc(docId).update(syncUpt));\n        }\n    })\n    return Promise.all(promises).then(() => {\n        return docRef.update(docDat);\n    });\n}\nfunction normSave() {\n    saveDoc().then(() => {\n        if (eventToShow) showEvent();//IMPORTANT\n        if (saved) clearInterval(savedInterval);\n        saved = true;\n        savedInterval = setInterval(() => {\n            let minutes = Math.floor((Date.now() - lastSave) / 60000);\n            if (minutes < 60) document.getElementById('tagLstSave').innerText = \"Guardado hace \" + minutes + \" minutos\";\n            else document.getElementById('tagLstSave').innerText = \"Guardado hace \" + Math.floor(minutes / 60) + \" horas\";\n        }, 300010);\n        document.getElementById('tagLstSave').innerText = \"Se han guardado los cambios\";\n        lastSave = Date.now();\n        console.log('Saved!');\n    }).catch(err => {\n        document.getElementById('tagLstSave').innerText = \"Error, no se han guardado todos los cambios: \" + err.code;\n        console.log(err);\n    });\n}\n\nfunction setprog(bar, n) {\n    bar = document.getElementById(bar);\n    n = Math.floor(n);\n    bar.setAttribute('aria-valuenow', n);\n    bar.style.width = n + '%';\n    bar.innerText = n + '%';\n}\nfunction runprog(bar, b, e) {\n    b = Math.floor(b);\n    e = Math.floor(e);\n    for (let i = b; i <= e; i++) {\n        setTimeout(() => {\n            setprog(bar, i);\n        }, 5);\n    }\n}\n\nfunction showEvent() {\n    Object.keys(docDat.events).forEach(key => {\n        hideEl(document.getElementById(key));\n    });\n    document.getElementById('mdlEventInfoL').innerHTML = docDat.events[eventToShow].date[lang];\n    showEl(document.getElementById(eventToShow));\n    enable(document.getElementById('btnPriorEve'));\n    enable(document.getElementById('btnNextEve'));\n}\ndocument.getElementById('btnPriorEve').onclick = () => {\n    let orderedKeys = Object.keys(docDat.events).slice().sort((a, b) => {\n        if (Number(a[0]) == Number(b[0])) {\n            if (a.substring(1, 4) == b.substring(1, 4)) {\n                return Number(a[4]) - Number(b[4]);\n            }\n            switch (a.substring(1, 4)) {\n                case \"sun\":\n                    return -1;\n                case \"mon\":\n                    if (b.substring(1, 4) == \"sun\") return 1;\n                    return -1;\n                case \"tue\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\") return 1\n                    return -1;\n                case \"wed\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\") return 1\n                    return -1;\n                case \"thu\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\") return 1\n                    return -1;\n                case \"fri\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\" || b.substring(1, 4) == \"thu\") return 1\n                    return -1;\n                case \"sat\":\n                    return 1;\n            }\n        }\n        return Number(a[0]) - Number(b[0]);\n    });\n    let n = orderedKeys.indexOf(eventToShow) - 1;\n    if (n >= 0) {\n        eventToShow = orderedKeys[n];\n        showEvent();\n    } else {\n        disable(document.getElementById('btnPriorEve'));\n    }\n};\ndocument.getElementById('btnNextEve').onclick = () => {\n    let orderedKeys = Object.keys(docDat.events).slice().sort((a, b) => {\n        if (Number(a[0]) == Number(b[0])) {\n            if (a.substring(1, 4) == b.substring(1, 4)) {\n                return Number(a[4]) - Number(b[4]);\n            }\n            switch (a.substring(1, 4)) {\n                case \"sun\":\n                    return -1;\n                case \"mon\":\n                    if (b.substring(1, 4) == \"sun\") return 1;\n                    return -1;\n                case \"tue\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\") return 1\n                    return -1;\n                case \"wed\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\") return 1\n                    return -1;\n                case \"thu\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\") return 1\n                    return -1;\n                case \"fri\":\n                    if (b.substring(1, 4) == \"sun\" || b.substring(1, 4) == \"mon\" || b.substring(1, 4) == \"tue\" || b.substring(1, 4) == \"wed\" || b.substring(1, 4) == \"thu\") return 1\n                    return -1;\n                case \"sat\":\n                    return 1;\n            }\n        }\n        return Number(a[0]) - Number(b[0]);\n    });\n    let n = orderedKeys.indexOf(eventToShow) + 1;\n    if (n < orderedKeys.length) {\n        eventToShow = orderedKeys[n];\n        showEvent();\n    } else {\n        disable(document.getElementById('btnNextEve'));\n    }\n};\n\nfunction render() {\n    document.getElementById('weeksCont').innerHTML = \"\";\n    docDat.weeks.forEach((week, wIdx) => {\n        let weekRow = document.createElement('tr');\n        weekRow.style.height = '10rem';\n        document.getElementById('weeksCont').appendChild(weekRow);\n        for (let i = 0; i < 7; i++) {\n            let day = week[daysOfWeek[i]]\n            let dayCell = document.createElement('td');\n            classes(dayCell, \"p-0\");\n            weekRow.appendChild(dayCell);\n            if (day) {\n                let num = document.createElement('p');\n                classes(num, \"m-0 p-1\");\n                num.style.fontSize = 'x-large';\n                num.innerHTML = '<b>' + day.date + '</b>';\n                dayCell.appendChild(num);\n\n                let events = document.createElement('div');\n                classes(events, \"autoOverflow\");\n                events.style.maxHeight = '7rem';\n                day.events.forEach((event, idx) => {\n                    let btnEvent = document.createElement('button');\n                    btnEvent.setAttribute(\"data-toggle\", \"modal\");\n                    btnEvent.setAttribute(\"data-target\", \"#mdlEventInfo\");\n                    classes(btnEvent, \"btn text-left p-1 mb-1 w-100\");\n                    btnEvent.style.backgroundColor = \"#c3e6cb\";\n                    btnEvent.style.borderColor = \"#8fd19e\";\n                    btnEvent.innerHTML = '<small>' + event.name + '</small>';\n                    btnEvent.onclick = () => {\n                        eventToShow = wIdx + daysOfWeek[i] + idx;\n                        showEvent();\n                    }\n                    events.appendChild(btnEvent);\n                });\n                let btnPlusEvent = document.createElement('button');\n                classes(btnPlusEvent, \"btn btn-scckie btn-block btn-sm\");\n                btnPlusEvent.innerHTML = '<i class=\"fas fa-plus\"></i>';\n                btnPlusEvent.onclick = () => {\n                    docDat.events[wIdx + daysOfWeek[i] + day.events.length] = {\n                        date: {\n                            es: longDay[\"es\"][i] + \" \" + day.date + \" de \" + fullMonth(docId % 100, lang),\n                            en: longDay[\"en\"][i] + \", \" + fullMonth(docId % 100, \"en\") + \" \" + day.date\n                        },\n                        typeIdx: 0,\n                        vals: {\n                            0: { label: \"Título\", val: \"Evento sin nombre\" },\n                            1: { label: \"Description\", val: \"Sin descripción\" },\n                        },\n                        name: \"Evento sin nombre\",\n                        description: \"Sin descripción\",\n                        visibilidad: calConfig.visOpts[lang][0],\n                        horario: [\"Ciudad de México:\", \"Bogotá:\", \"Madrid:\"]\n                    };\n                    day.events.push({\n                        name: \"Evento sin nombre\"\n                    });\n                    normSave();\n                }\n                events.appendChild(btnPlusEvent);\n                dayCell.appendChild(events);\n            }\n        }\n    });\n    document.getElementById('eventInfoCont').innerHTML = \"\";\n    for (const [key, event] of Object.entries(docDat.events)) {\n        let changed = false;\n\n        //@#Migration\n        if (event.typeIdx == undefined) {\n            event.typeIdx = 0;\n            event.vals = {\n                0: { label: \"Título\", val: event.name },\n                1: { label: \"Description\", val: event.description },\n            }\n            regenTxt();\n            changed = true;\n        }\n        if (typeof event.date != \"object\") {\n            event.date = {\n                es: longDay[\"es\"][daysOfWeek.indexOf(key.substring(1, 4))] + \" \" + docDat.weeks[parseInt(key.charAt(0))][key.substring(1, 4)].date + \" de \" + fullMonth(docId % 100, lang),\n                en: longDay[\"en\"][daysOfWeek.indexOf(key.substring(1, 4))] + \", \" + fullMonth(docId % 100, \"en\") + \" \" + docDat.weeks[parseInt(key.charAt(0))][key.substring(1, 4)].date\n            }\n            changed = true;\n        }\n        //End migration\n\n        let form = document.createElement('div');\n        form.id = key;\n        classes(form, \"d-none overflow-auto\");\n        let bod = document.createElement('div');\n        classes(bod, \"modal-body\");\n        form.appendChild(bod);\n\n        let fsec = document.createElement('div');\n        classes(fsec, \"d-none\");\n        bod.appendChild(fsec);\n        let fgType = document.createElement('div');\n        classes(fgType, \"form-group\");\n        fsec.appendChild(fgType);\n\n        let selTypeMainL = document.createElement('label');\n        if (lang == \"es\") {\n            selTypeMainL.innerText = \"Tipo de evento\";\n        } else if (lang == \"en\") {\n            selTypeMainL.innerText = \"Event type\";\n        }\n        fgType.appendChild(selTypeMainL);\n        let selTypeMain = document.createElement('select');\n        classes(selTypeMain, \"form-control\");\n        selTypeMain.setAttribute('multiple', 'true');\n        calConfig[lang].forEach((itm, idx) => {\n            let opt = document.createElement('option');\n            opt.value = idx;\n            opt.innerText = itm.label;\n            if ((!event.typeIdx && idx == 0) || idx == event.typeIdx) opt.setAttribute('selected', 'true');\n            selTypeMain.appendChild(opt);\n        });\n        selTypeMain.oninput = () => {\n            changed = true;\n            event.typeIdx = parseInt(selTypeMain.value);\n            if (!event.typeIdx) event.typeIdx = 0;\n            event.vals = {};\n            reloadForm();\n        }\n        fgType.appendChild(selTypeMain);\n\n        let inTitleHid = document.createElement('input');\n        inTitleHid.setAttribute(\"type\", \"text\");\n        inTitleHid.id = \"inEveTitle\" + key;\n        let inDescHid = document.createElement('textarea');\n        inDescHid.id = \"inEveDesc\" + key;\n\n        let fRow = document.createElement('div');\n        classes(fRow, \"form-row\");\n        fsec.insertBefore(fRow, fgType.nextSibling);\n\n        //Must be declared here\n        let sfRow = document.createElement('div');\n        classes(sfRow, \"form-row d-none\");\n        fsec.insertBefore(sfRow, fRow.nextSibling);\n\n        function reloadForm() {\n            fRow.innerHTML = \"\";\n            calConfig[lang][event.typeIdx].options.forEach((option, idx) => {\n                let fCol = document.createElement('div');\n                classes(fCol, \"col-auto form-group\");\n                let label = document.createElement('label');\n                label.innerText = option.label;\n                fCol.appendChild(label);\n                let inp;\n                switch (option.type) {\n                    case \"select\":\n                        inp = document.createElement('select');\n                        option.options.forEach((itm, i) => {\n                            let opt = document.createElement('option');\n                            opt.value = itm.val;\n                            opt.innerHTML = itm.label;\n                            if ((i == 0 && (!event.vals || !event.vals[idx])) || (event.vals && event.vals[idx] && event.vals[idx].val == itm.val)) {\n                                opt.selected = true;\n                                event.vals[idx] = {\n                                    label: itm.label,\n                                    val: itm.val,\n                                }\n                                if (option.valForSub == itm.val) showEl(sfRow);\n                                else hideEl(sfRow);\n                            }\n                            inp.appendChild(opt);\n                        });\n                        break;\n                    case \"textarea\":\n                        inp = document.createElement('textarea');\n                        inp.setAttribute(\"rows\", \"3\");\n                        if (event.vals[idx] && event.vals[idx].val) inp.value = event.vals[idx].val;\n                        break;\n                    default:\n                        inp = document.createElement('input');\n                        inp.setAttribute(\"type\", option.type);\n                        if (event.vals[idx] && event.vals[idx].val) inp.value = event.vals[idx].val;\n                }\n                if (option.placeholder) inp.placeholder = option.placeholder;\n                classes(inp, \"form-control form-control-sm\");\n                fCol.appendChild(inp);\n                fRow.appendChild(fCol);\n\n                //sfRow declared before\n                if (option.valForSub) {\n                    option.sub.forEach((soption, sidx) => {\n                        let sfCol = document.createElement('div');\n                        classes(sfCol, \"col-auto form-group\");\n                        let slabel = document.createElement('label');\n                        slabel.innerText = soption.label;\n                        sfCol.appendChild(slabel);\n                        let sinp;\n                        switch (soption.type) {\n                            case \"select\":\n                                sinp = document.createElement('select');\n                                soption.options.forEach((itm, i) => {\n                                    let opt = document.createElement('option');\n                                    opt.value = itm.val;\n                                    opt.innerHTML = itm.label;\n                                    if ((i == 0 && (!event.vals || !event.vals[idx + '-' + sidx])) || (event.vals && event.vals[idx + '-' + sidx] && event.vals[idx + '-' + sidx].val == itm.val)) {\n                                        opt.selected = true;\n                                        event.vals[idx + '-' + sidx] = {\n                                            label: itm.label,\n                                            val: itm.val,\n                                        }\n                                    }\n                                    sinp.appendChild(opt);\n                                });\n                                break;\n                            case \"textarea\":\n                                sinp = document.createElement('textarea');\n                                sinp.setAttribute(\"rows\", \"3\");\n                                if (event.vals[idx + '-' + sidx] && event.vals[idx + '-' + sidx].val) sinp.value = event.vals[idx + '-' + sidx].val;\n                                break;\n                            default:\n                                sinp = document.createElement('input');\n                                sinp.setAttribute(\"type\", soption.type);\n                                if (event.vals[idx + '-' + sidx] && event.vals[idx + '-' + sidx].val) sinp.value = event.vals[idx + '-' + sidx].val;\n                        }\n                        if (soption.placeholder) sinp.placeholder = soption.placeholder;\n                        classes(sinp, \"form-control form-control-sm\");\n                        sfCol.appendChild(sinp);\n                        sfRow.appendChild(sfCol);\n\n                        sinp.onchange = function () {\n                            changed = true;\n                            event.vals[idx + '-' + sidx] = {};\n                            event.vals[idx + '-' + sidx].val = sinp.value;\n                            if (option.type == \"select\") event.vals[idx + '-' + sidx].label = sinp.innerText;\n                            else event.vals[idx + '-' + sidx].label = soption.label;\n                            regenTxt();\n                        }\n                    });\n                }\n\n                inp.onchange = function () {\n                    changed = true;\n                    event.vals[idx] = {};\n                    event.vals[idx].val = inp.value;\n                    if (option.type == \"select\") event.vals[idx].label = inp.innerText;\n                    else event.vals[idx].label = option.label;\n                    if (option.valForSub) {\n                        if (option.valForSub == inp.value) showEl(sfRow);\n                        else hideEl(sfRow);\n                    }\n                    regenTxt();\n                }\n            });\n        }\n        reloadForm();\n\n        function regenTxt() {\n            if (calConfig[lang][event.typeIdx].multipleTxt) {\n                event.description = parseInt(event.vals[\"0\"].val.charAt(0));\n                event.name = parseInt(event.vals[\"0\"].val.charAt(1));\n            } else {\n                event.description = event.name = 0;\n            }\n            event.description = calConfig[lang][event.typeIdx].text[event.description];\n            event.name = calConfig[lang][event.typeIdx].titleTxt[event.name];\n            for (const [vKey, vVal] of Object.entries(event.vals)) {\n                event.description = event.description.replaceAll(\"$\" + vKey + \"L$\", vVal.label);\n                event.description = event.description.replaceAll(\"$\" + vKey + \"$\", vVal.val);\n                event.description = event.description.replaceAll(\"$g-year$\", Math.floor(docId / 100));\n                event.name = event.name.replaceAll(\"$\" + vKey + \"L$\", vVal.label);\n                event.name = event.name.replaceAll(\"$\" + vKey + \"$\", vVal.val);\n                event.name = event.name.replaceAll(\"$g-year$\", Math.floor(docId / 100));\n            }\n        }\n        regenTxt();\n\n        let fgVis = document.createElement('div');\n        classes(fgVis, \"form-group\");\n        fsec.appendChild(fgVis);\n        fgVis.innerHTML = '<label>Visiblidad</label>';\n        let inVis = document.createElement('select');\n        inVis.id = \"inVis\" + key;\n        classes(inVis, \"form-control\");\n        calConfig.visOpts[lang].forEach((itm, idx) => {\n            let opt = document.createElement('option');\n            opt.value = idx;\n            opt.innerHTML = itm;\n            if (itm == event.visibilidad) opt.setAttribute('selected', \"true\");\n            inVis.appendChild(opt);\n        });\n        fgVis.appendChild(inVis);\n\n        let fgTime = document.createElement('div');\n        classes(fgTime, \"form-group\");\n        fsec.appendChild(fgTime);\n        fgTime.innerHTML = '<label>Horario</label>';\n        let inTime = document.createElement('textarea');\n        classes(inTime, \"form-control\");\n        inTime.id = \"inTime\" + key;\n        inTime.setAttribute(\"rows\", \"4\");\n        fgTime.appendChild(inTime);\n        if (inVis.value == 5) hideEl(fgTime);\n        else showEl(fgTime);\n\n        inVis.oninput = () => {\n            changed = true;\n            if (inVis.value == 5) hideEl(fgTime);\n            else showEl(fgTime);\n        };\n        inTime.onchange = () => {\n            changed = true;\n        };\n\n        //Must be declared here\n        let saveBtn = document.createElement('button');\n\n        let selLangCC = document.createElement('div');\n        classes(selLangCC, \"row\");\n        let selLangC = document.createElement('div');\n        classes(selLangC, \"col-auto\");\n        selLangCC.appendChild(selLangC);\n        let selLang = document.createElement('select');\n        classes(selLang, \"form-control ml-auto h-100\");\n        selLang.setAttribute(\"name\", \"selTransLang\");\n        selLangC.appendChild(selLang);\n        let btnTrans = document.createElement('button');\n        classes(btnTrans, 'btn btn-scckie mx-2');\n        btnTrans.innerHTML = '<i class=\"fas fa-language\"></i>';\n        btnTrans.onclick = function () {\n            db.collection('calendars/langs/' + selLang.value).doc(docId).get().then(async function (doc) {\n                let newEve = doc.data().events[key];\n                if (!newEve) return;\n                event.typeIdx = newEve.typeIdx;\n                event.vals = newEve.vals;\n                console.log(event.vals);\n                for (let i = 0; i < calConfig[lang][event.typeIdx].options.length; i++) {\n                    const option = calConfig[lang][event.typeIdx].options[i];\n                    if (option.type == \"select\") {\n                        event.vals[i] = option.options[\n                            calConfig[selLang.value][event.typeIdx].options[i].options\n                                .map(function (e) {\n                                    return e.val;\n                                })\n                                .indexOf(event.vals[i].val)\n                        ];\n                    } else {\n                        if (option.translatable) {\n                            event.vals[i].val = await translateSimple(event.vals[i].val, selLang.value, lang)\n                        }\n                        event.vals[i].label = option.label;\n                    }\n                    if (event.vals[i].val == option.valForSub) {\n                        for (let j = 0; j < calConfig[lang][event.typeIdx].options[i].sub.length; j++) {\n                            const opt = calConfig[lang][event.typeIdx].options[i].sub[j];\n                            if (opt.type == \"select\") {\n                                console.log(event.vals[i + \"-\" + j]);\n                                console.log(option.options);\n                                event.vals[i + \"-\" + j] = option.options[\n                                    calConfig[selLang.value][event.typeIdx].options[i].options\n                                        .map(function (e) {\n                                            return e.val;\n                                        })\n                                        .indexOf(event.vals[i + \"-\" + j].val)\n                                ];\n                                console.log(event.vals[i + \"-\" + j]);\n                            } else {\n                                if (opt.translatable) {\n                                    event.vals[i + \"-\" + j].val = await translateSimple(event.vals[i + \"-\" + j].val, selLang.value, lang)\n                                }\n                                event.vals[i + \"-\" + j].label = opt.label;\n                            }\n                        }\n                    }\n                }\n                event.visibilidad = calConfig.visOpts[lang][calConfig.visOpts[selLang.value].indexOf(newEve.visibilidad)];\n                event.horario = [];\n                for (let i = 0; i < newEve.horario.length; i++) {\n                    event.horario.push(await translateSimple(newEve.horario[i], selLang.value, lang));\n                }\n                inTime.innerHTML = \"\";\n                event.horario.forEach(time => {\n                    inTime.innerHTML += time + \"\\n\";\n                });\n                changed = true;\n                saveBtn.click();\n            }).catch(err => console.log(err));\n        }\n        selLangCC.appendChild(btnTrans);\n        fsec.appendChild(selLangCC);\n\n        let tsec = document.createElement('div');\n        bod.appendChild(tsec);\n        let eveTit = document.createElement('h3');\n        eveTit.innerHTML = event.name;\n        tsec.appendChild(eveTit);\n        let eveDesc = document.createElement('p');\n        eveDesc.innerHTML = event.description;\n        tsec.appendChild(eveDesc);\n        let eveVis = document.createElement('p');\n        eveVis.innerHTML = \"Visibilidad: \" + event.visibilidad;\n        tsec.appendChild(eveVis);\n        let eveTime = document.createElement('p');\n        classes(eveTime, \"mb-0\");\n        eveTime.innerHTML = \"Horario: \";\n        tsec.appendChild(eveTime);\n        let eveTimeLst = document.createElement('ul');\n        tsec.appendChild(eveTimeLst);\n        event.horario.forEach(time => {\n            let li = document.createElement('li');\n            li.innerHTML = time;\n            eveTimeLst.appendChild(li);\n        });\n        if (event.visibilidad == calConfig.visOpts[lang][5]) {\n            hideEl(eveTime);\n            hideEl(eveTimeLst);\n        }\n        else {\n            showEl(eveTime);\n            showEl(eveTimeLst);\n        }\n\n\n        let foot = document.createElement('div');\n        classes(foot, \"modal-footer\");\n        form.appendChild(foot);\n\n        let delBtn = document.createElement('button');\n        classes(delBtn, \"btn btn-danger mr-auto\")\n        delBtn.setAttribute(\"type\", \"button\");\n        delBtn.innerText = \"Borrar\";\n        delBtn.onclick = () => {\n            for (let i = Number(key.substr(4)) + 1; i < docDat.weeks[Number(key[0])][key.substr(1, 3)].events.length; i++) {\n                docDat.events[key.substr(0, 4) + (i - 1)] = docDat.events[key.substr(0, 4) + i]\n            }\n            delete docDat.events[key.substr(0, 4) + (docDat.weeks[Number(key[0])][key.substr(1, 3)].events.length - 1)];\n            docDat.weeks[Number(key[0])][key.substr(1, 3)].events.splice(Number(key.substr(4)), 1);\n            $('#mdlEventInfo').modal('hide');\n            eventToShow = null;\n            normSave();\n        };\n        foot.appendChild(delBtn);\n        let editBtn = document.createElement('button');\n        classes(editBtn, \"btn btn-info\");\n        editBtn.setAttribute(\"type\", \"button\");\n        editBtn.innerText = \"Editar\";\n        editBtn.onclick = () => {\n            inVis.value = calConfig.visOpts[lang].indexOf(event.visibilidad);\n            if (inVis.value == 5) hideEl(fgTime);\n            else showEl(fgTime);\n            inTime.innerHTML = \"\";\n            event.horario.forEach(time => {\n                inTime.innerHTML += time + \"\\n\";\n            });\n            hideEl(tsec);\n            showEl(fsec);\n            showEl(saveBtn);\n            enable(saveBtn);\n            hideEl(editBtn);\n        };\n        foot.appendChild(editBtn);\n        //Declared before\n        classes(saveBtn, \"btn btn-scckie d-none\");\n        saveBtn.setAttribute(\"type\", \"button\");\n        disable(saveBtn);\n        saveBtn.innerText = \"Guardar\";\n        saveBtn.onclick = () => {\n            disable(saveBtn);\n            if (changed) {\n                regenTxt();\n                docDat.weeks[Number(key[0])][key.substr(1, 3)].events[key[4]].name = event.name;\n                event.visibilidad = calConfig.visOpts[lang][inVis.value];\n                event.horario = [];\n                inTime.value.trim().split('\\n').forEach(time => {\n                    if (time != \"\" && time != \" \") event.horario.push(time);\n                });\n                normSave();\n            }\n            hideEl(fsec);\n            showEl(tsec);\n            hideEl(saveBtn);\n            showEl(editBtn);\n        };\n        foot.appendChild(saveBtn);\n\n        document.getElementById('eventInfoCont').appendChild(form);\n    }\n\n    document.getElementsByName('selTransLang').forEach(itm => {\n        itm.innerHTML = '';\n    });\n    langs.forEach((l, i) => {\n        if (l != lang) {\n            let opt = document.createElement('option');\n            if (i == 0) {\n                opt.setAttribute('selected', 'true');\n            }\n            opt.value = opt.innerText = l;\n            document.getElementsByName('selTransLang').forEach(itm => {\n                itm.appendChild(opt.cloneNode(true));\n            });\n        }\n    });\n}\n\n\nfunction resetChgImg(uncheck) {\n    document.getElementById('prevMed').src = docDat.picUrl;\n    if (uncheck) {\n        document.getElementById('inMedSrc0').checked = false;\n        document.getElementById('inMedSrc1').checked = false;\n    }\n    document.getElementById('inChgImg').value = \"\";\n    document.getElementById('inChgImgUrl').value = \"\";\n    document.getElementById('inChgImg').removeAttribute('required');\n    document.getElementById('inChgImgUrl').removeAttribute('required');\n    hideEl(document.getElementById(\"barChgImgCont\"));\n    hideEl(document.getElementById(\"inChgImgFileCont\"));\n    hideEl(document.getElementById(\"inChgImgUrlCont\"));\n    document.getElementById(\"btnCnfChgImg\").removeAttribute('disabled');\n    document.getElementById(\"btnCanChgImg\").removeAttribute('disabled');\n}\ndocument.getElementById('btnChgImg').onclick = () => {\n    resetChgImg(true);\n    toggleEl(document.getElementById(\"frmChgImg\"));\n};\ndocument.getElementById('inChgImg').addEventListener('change', e => {\n    newMedia = e.target.files[0];\n    function prevMed() {\n        var read = new FileReader();\n        read.readAsDataURL(newMedia);\n        read.onload = function (e2) {\n            document.getElementById(\"prevMed\").src = e2.target.result;\n        };\n    };\n    newMedia.name = ultraClean(newMedia.name, '');\n    document.getElementById('inChgImgL').innerHTML = newMedia.name;\n    prevMed(newMedia);\n});\ndocument.getElementById('inChgImgUrl').onchange = function () {\n    document.getElementById(\"prevMed\").src = document.getElementById('inChgImgUrl').value;\n};\ndocument.getElementById('inMedSrc0').onclick = function () {\n    newMedSrc = \"home\";\n    resetChgImg(false);\n    document.getElementById('inChgImg').setAttribute('required', 'true');\n    showEl(document.getElementById(\"inChgImgFileCont\"));\n}\ndocument.getElementById('inMedSrc1').onclick = function () {\n    newMedSrc = \"out\";\n    resetChgImg(false);\n    document.getElementById('inChgImgUrl').setAttribute('required', 'true');\n    showEl(document.getElementById(\"inChgImgUrlCont\"));\n}\n\ndocument.getElementById('btnPrevCal').onclick = function () {\n    docDat.timePrev = new firebase.firestore.Timestamp.fromMillis((new Date(Date.now())).getTime() + 10 * 60000);\n    normSave();\n};\ndocument.getElementById('btnPrevMail').onclick = function () {\n    docDat.timePrev = new firebase.firestore.Timestamp.fromMillis((new Date(Date.now())).getTime() + 10 * 60000);\n    normSave();\n};\n\nfunction validateRevision() {\n    let revLangs = 0;\n    langs.forEach(l => {\n        let rev = docDat.revised[l] ? docDat.revised[l].length : 0;\n        if (docDat.revised[l] && !docDat.revised[l].includes(uid)) rev++;\n        if (rev >= 2) revLangs++;\n    });\n    return revLangs == langs.length;\n}\n\ndocument.getElementById('btnAprove').onclick = function () {\n    if (docDat.revised[lang] && docDat.revised[lang].includes(uid)) {\n        docDat.revised[lang].splice(docDat.revised[lang].indexOf(uid), 1);\n        document.getElementById('btnAprove').innerHTML = '<i class=\"far fa-check-square\"></i>';\n    } else {\n        if (!docDat.revised[lang]) docDat.revised[lang] = [];\n        docDat.revised[lang].push(uid);\n        document.getElementById('btnAprove').innerHTML = '<i class=\"fas fa-check-square\"></i>';\n    }\n    if (validateRevision()) {\n        docDat.finished = true;\n        newCal();\n    } else {\n        docDat.finished = false;\n    }\n    normSave();\n};\n\nfunction newCal() {\n    let nextCalID;\n    rtDb.ref('nextCal').transaction(nCal => {\n        if (nCal) {\n            nextCalID = nCal;\n            nCal++;\n            if (nCal % 100 == 13) {\n                nCal -= 12;\n                nCal += 100;\n            }\n        }\n        return nCal;\n    }, (error) => {\n        if (error) {\n            console.log(error);\n        } else {\n            let date = new Date((nextCalID - nextCalID % 100) / 100 + ' ' + nextCalID % 100 + ' ' + '00:00');\n            let weeks = [];\n            let days;\n            if (date.getMonth() == 1) {\n                if (date.getFullYear() % 4 == 0) {\n                    days = 29;\n                } else {\n                    days = 28;\n                }\n            } else if (date.getMonth() % 2 == 0) {\n                if (date.getMonth() <= 6) days = 31;\n                else days = 30;\n            } else {\n                if (date.getMonth() <= 6) days = 30;\n                else days = 31;\n            }\n            let bDay = date.getDay();\n            for (let i = 1; i <= days; i = i) {\n                let week = {};\n                for (let j = bDay; j < daysOfWeek.length; j++) {\n                    if (i > days) break;\n                    week[daysOfWeek[j]] = {\n                        date: i,\n                        events: []\n                    }\n                    i++;\n                }\n                weeks.push(week);\n                bDay = 0;\n            }\n            const promises = [];\n            langs.forEach(l => {\n                let newC = {\n                    events: {},\n                    published: firebase.firestore.Timestamp.fromDate(date),\n                    description: \"\",\n                    descriptionShort: \"\",\n                    finished: false,\n                    pastDue: false,\n                    picUrl: \"\",\n                    picAlt: \"\",\n                    picCapt: \"\",\n                    public: false,\n                    sentMail: false,\n                    revised: {},\n                    title: \"\",\n                    url: \"\",\n                    nextCal: \"\",\n                    priorCal: \"\",\n                    weeks: weeks,\n                    translations: {}\n                }\n\n                let intId = parseInt(nextCalID);\n                let year = (intId - intId % 100) / 100;\n                let nYear = (intId - intId % 100) / 100;\n                let pYear = (intId - intId % 100) / 100;\n                if (intId % 100 == 12) nYear++;\n                if (intId % 100 == 1) pYear--;\n                let month = fullMonth(intId % 100, l);\n                let nMonth = fullMonth(intId % 100 + 1, l).toLowerCase();\n                let pMonth = fullMonth(intId % 100 - 1, l).toLowerCase();\n                let calsText = \"\";\n                switch (l) {\n                    case \"es\":\n                        calsText = \"calendario-astronomico\";\n                        newC.title = \"Calendario Astronómico de \" + month + \" \" + year;\n                        break;\n                    case \"en\":\n                        calsText = \"astronomic-calendar\";\n                        newC.title = \"Astronomic Calendar of \" + month + \" \" + year;\n                        break;\n                }\n                newC.url = \"https://sciencecookies.net/\" + calsText + \"/\" + year + \"/\" + month.toLowerCase() + \"/\";\n                newC.nextCal = \"https://sciencecookies.net/\" + calsText + \"/\" + nYear + \"/\" + nMonth + \"/\";\n                newC.priorCal = \"https://sciencecookies.net/\" + calsText + \"/\" + pYear + \"/\" + pMonth + \"/\";\n\n                promises.push(db.collection('calendars/langs/' + l).doc(Math.abs(nextCalID).toString()).set(newC));\n\n            })\n            return Promise.all(promises).then(() => {\n                console.log('exito');\n            }).catch(err => console.log(err));\n        }\n    });\n}\n\n$('#mdlPublish').on('show.bs.modal', e => {\n    if (validateRevision()) {\n        showEl(document.getElementById('btnCnfPublish'));\n        document.getElementById('mdlPublishTxt').innerText = \"El calendario está listo para publicar\";\n    } else {\n        hideEl(document.getElementById('btnCnfPublish'));\n        document.getElementById('mdlPublishTxt').innerText = \"Para publicar es necesario que lo hayan aprovado al menos dos personas.\";\n    }\n});\n\ndocument.getElementById('btnCnfPublish').onclick = function () {\n    if (docDat.public) return;\n    setprog('barPublish', 0);\n    showEl(document.getElementById('barPublishCont'));\n\n    docDat.public = true;\n    setprog('barPublish', 25);\n\n    saveDoc().then(() => {\n        setprog('barPublish', 58);\n        admin.database().ref('calendarios/' + docId).set({\n            pop: 0\n        }, err => {\n            if (err) {\n                if (lang == \"es\") {\n                    alertTop(\"<strong>¡Ha ocurrido un error!</strong> \" + err.code, 0);\n                } else if (lang == \"en\") {\n                    alertTop(\"<strong>¡There has been an error!</strong> \" + err.code, 0);\n                }\n                console.log(err);\n            } else {\n                setprog('barPublish', 100);\n                classes(document.getElementById('barPublish'), 'bg-success');\n                if (lang == \"es\") {\n                    alertTop(\"Publicado correctamente\", 1);\n                } else if (lang == \"en\") {\n                    alertTop(\"Published successfully\", 1);\n                }\n                setTimeout(function () {\n                    window.open(docDat.url, '_blank').focus();\n                }, 2500);\n                $('#mdlPublish').modal('hide');\n                console.log('Published ' + docId + ' calendar');\n                return null;\n            }\n        });\n    }).catch(err => {\n        if (lang == \"es\") {\n            alertTop(\"<strong>¡Ha ocurrido un error!</strong> \" + err.code, 0);\n        } else if (lang == \"en\") {\n            alertTop(\"<strong>¡There has been an error!</strong> \" + err.code, 0);\n        }\n        console.log(err);\n    });\n};"],"names":["$a15b832e2152a95d3323ba3c2a34be40$var$store","firebase","storage","$a15b832e2152a95d3323ba3c2a34be40$var$rtDb","database","$a15b832e2152a95d3323ba3c2a34be40$var$docDat","$a15b832e2152a95d3323ba3c2a34be40$var$docId","$a15b832e2152a95d3323ba3c2a34be40$var$docRef","$a15b832e2152a95d3323ba3c2a34be40$var$calConfig","$a15b832e2152a95d3323ba3c2a34be40$var$lastSave","Date","now","$a15b832e2152a95d3323ba3c2a34be40$var$saved","$a15b832e2152a95d3323ba3c2a34be40$var$newMedia","$a15b832e2152a95d3323ba3c2a34be40$var$newMedSrc","$a15b832e2152a95d3323ba3c2a34be40$var$eventToShow","$a15b832e2152a95d3323ba3c2a34be40$var$translateSimple","text","from","target","translate","app","functions","httpsCallable","data","$a15b832e2152a95d3323ba3c2a34be40$var$daysOfWeek","$a15b832e2152a95d3323ba3c2a34be40$var$longDay","$a15b832e2152a95d3323ba3c2a34be40$var$fullMonth","n","l","$a15b832e2152a95d3323ba3c2a34be40$var$savedInterval","$a15b832e2152a95d3323ba3c2a34be40$var$saveDoc","console","log","promises","langs","forEach","lang","syncUpt","published","finished","pastDue","public","sentMail","revised","translations","timePrev","url","push","db","collection","doc","update","Promise","all","then","$a15b832e2152a95d3323ba3c2a34be40$var$normSave","$a15b832e2152a95d3323ba3c2a34be40$var$showEvent","clearInterval","setInterval","minutes","Math","floor","document","getElementById","innerText","catch","err","code","$a15b832e2152a95d3323ba3c2a34be40$var$setprog","bar","setAttribute","style","width","$a15b832e2152a95d3323ba3c2a34be40$var$runprog","b","e","i","setTimeout","Object","keys","events","key","hideEl","innerHTML","date","showEl","enable","$a15b832e2152a95d3323ba3c2a34be40$var$resetChgImg","uncheck","src","picUrl","checked","value","removeAttribute","$a15b832e2152a95d3323ba3c2a34be40$var$validateRevision","revLangs","rev","length","includes","uid","window","loaded","descFrm","description","trim","descriptionShort","get","calendarsFSRef","urlSrch","onSnapshot","doc1","exists","id","title","picCapt","picAlt","weeks","week","wIdx","weekRow","createElement","height","appendChild","day","dayCell","classes","num","fontSize","maxHeight","event","idx","btnEvent","backgroundColor","borderColor","name","onclick","btnPlusEvent","es","en","typeIdx","vals","0","label","val","1","visibilidad","visOpts","horario","entries","changed","undefined","regenTxt","indexOf","substring","parseInt","charAt","form","bod","fsec","fgType","selTypeMainL","selTypeMain","itm","opt","oninput","reloadForm","inTitleHid","fRow","insertBefore","nextSibling","sfRow","options","option","fCol","inp","type","selected","valForSub","placeholder","sub","soption","sidx","sfCol","sinp","slabel","onchange","multipleTxt","titleTxt","vKey","vVal","replaceAll","fgVis","inVis","fgTime","inTime","saveBtn","selLangCC","selLangC","selLang","btnTrans","async","newEve","map","translatable","j","i1","time","click","tsec","eveTit","eveDesc","eveVis","eveTime","eveTimeLst","li","foot","delBtn","Number","substr","splice","$","modal","editBtn","disable","split","getElementsByName","cloneNode","$a15b832e2152a95d3323ba3c2a34be40$var$render","href","location","addEventListener","preventDefault","ori","docId","res","classList","remove","alertTop","ref","put","on","snap","bytesTransferred","totalBytes","getDownloadURL","medUrl","addMed","picDesc","picDescShort","orderedKeys","slice","sort","a","toggleEl","read","files","ultraClean","FileReader","readAsDataURL","onload","e2","result","firestore","Timestamp","fromMillis","getTime","nextCalID","transaction","nCal","error","days","getMonth","getFullYear","bDay","getDay","newC","fromDate","nextCal","priorCal","intId","year","nYear","pYear","month","nMonth","toLowerCase","pMonth","calsText","abs","toString","set","$a15b832e2152a95d3323ba3c2a34be40$var$newCal","admin","pop","open","focus"],"version":3,"file":"editCal.js.map"}