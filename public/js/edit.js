!function(){var e=firebase.storage(),t=firebase.database();let n,l,a,d,o=-1,c=-1,i=Date.now(),s=!1,r=-1,m=-1,u=null,p=null,h=[];async function g(e,t,n){let l=firebase.app().functions("us-east1").httpsCallable("translations-translateSimple");return(await l({text:e,from:t,target:n})).data}function b(){console.log("Saving...");let e=n.published.toDate(),t=e.getFullYear().toString();e.getMonth()<9&&(t+="0"),t+=e.getMonth()+1;let d="";switch(lang){case"es":d="galletas";break;case"en":d="cookies"}n.url="https://sciencecookies.net/"+d+"/"+t+"/"+n.file+"/",function(){let e=0;function t(){E("barPublish",e)}h=[],h.push(n.published.toDate().getFullYear().toString()),n.published.toDate().getFullYear().toString()!=n.ledit.toDate().getFullYear().toString()&&h.push(n.ledit.toDate().getFullYear().toString());e++,t(),n.authors.forEach((l=>{l.substring(1).split(" ").forEach((e=>{h.push(ultraClean(e,""))})),e+=3/n.authors.length,t()}));let l=[];n.title.split(" ").forEach((e=>{l.push(e.replaceAll(/(<([^>]*)>)/gi," ").trim())})),e++,t(),n.description.split(" ").forEach((a=>{l.push(a.replaceAll(/(<([^>]*)>)/gi," ").trim()),e+=3/n.description.split(" ").length,t()})),n.cont.forEach((a=>{"parra"==a.type?(Number(a.title)>0&&a.titleTxt.split(" ").forEach((e=>{l.push(e.replaceAll(/(<([^>]*)>)/gi," ").trim())})),a.text.split(" ").forEach((d=>{l.push(d.replaceAll(/(<([^>]*)>)/gi," ").trim()),e+=14/n.cont.length/a.text.split(" ").length,t()}))):"medSimple"==a.type&&(""!=a.alt&&a.alt.split(" ").forEach((e=>{l.push(e.replaceAll(/(<([^>]*)>)/gi," ").trim())})),""!=a.caption&&a.caption.split(" ").forEach((e=>{l.push(e.replaceAll(/(<([^>]*)>)/gi," ").trim())})),e+=14/n.cont.length,t())}));let a=[],d=l.length;for(let e=0;e<d;e++){let t=l[e];-1!=t.indexOf(" ")&&(t.split(" ").forEach((e=>{a.push(e)})),l.splice(e,1),e--,d--)}a.forEach((e=>{l.push(e)})),e++,t(),d=l.length;for(let n=0;n<d;n++)l.splice(n,1,ultraClean(l[n],"")),e+=3/l.length,t();let o={},c=0,i=0,s=["1","2","3","4","6","7","8","9","0","tan","ser","los","serian","pero","podemos","su","o","y","e","la","del","es","si","en","otro","de","tendrian","no","se","una","mas","el","a","embargo","las","sin","con","un","para","por","les","","vez","gran","este","esta","estos","estas","nos","al","dio","has","preguntado","el","lo","tu","tus","hacen","otros","para","ellos","ellas","ese","esa","esos","esas","detras","delante","nos","le","muy","casi","son","pues","a","ha","han","fue"];l.forEach((n=>{if(!s.includes(n)){o[n]?o[n]++:(o[n]=1,i++),c++}e+=3/l.length,t()}));for(const[n,l]of Object.entries(o))l>c/i&&h.push(n),e+=3/Object.entries(o).length,t();n.fixedCats.forEach((e=>{h.push(e)})),n.cats=h,console.log(h)}();const o=[];return langs.forEach((e=>{if(e!=lang){let t={authors:n.authors.slice(),media:n.media.slice(),java:n.java,notify:n.notify,public:n.public,beenPublic:n.beenPublic,dledit:n.dledit,created:n.created,ledit:n.ledit,published:n.published,pop:n.pop,likes:n.likes,favs:n.favs,revised:n.revised,translations:n.translations,fixedCats:n.fixedCats.slice(),timePrev:n.timePrev};t.fixedCats.forEach((function(n,l){t.fixedCats.splice(l,1,catTranslations[n][e])})),t.translations[lang]=n.url,o.push(db.collection("cookies/langs/"+e).doc(l).update(t))}})),Promise.all(o).then((()=>a.update(n)))}function f(){b().then((()=>{s&&clearInterval(d),s=!0,d=setInterval((()=>{let e=Math.floor((Date.now()-i)/6e4);document.getElementById("tagLstSave").innerText=e<60?"Guardado hace "+e+" minutos":"Guardado hace "+Math.floor(e/60)+" horas"}),300010),document.getElementById("tagLstSave").innerText="Se han guardado todos los cambios",i=Date.now()})).catch((e=>{document.getElementById("tagLstSave").innerText="Error, no se han guardado todos los cambios: "+e.code,console.log(e)}))}function E(e,t){e=document.getElementById(e),t=Math.floor(t),e.setAttribute("aria-valuenow",t),e.style.width=t+"%",e.innerText=t+"%"}function v(e,t,n){t=Math.floor(t),n=Math.floor(n);for(let l=t;l<=n;l++)setTimeout((()=>{E(e,l)}),5)}function y(){document.getElementById("contMedMan").innerHTML='<div class="col mb-4">\n        <div class="card text-dark bg-light h-100 cardBorder" style="border-color: #343a40;">\n            <a type="button" data-toggle="modal" data-target="#mdlAddMed" data-dismiss="modal" aria-label="Close" class="text-decoration-none text-dark h-100 d-flex align-items-center justify-content-center" onclick="addFrom=0;">\n                <h1 style="font-size: 6rem;" class="mb-0"><i class="far fa-plus-square"></i></h1>\n            </a>\n        </div>\n    </div>',document.getElementById("contMedCho").innerHTML='<div class="col mb-4">\n        <div class="card text-dark bg-light h-100 cardBorder" style="border-color: #343a40;">\n            <a type="button" data-toggle="modal" data-target="#mdlAddMed" data-dismiss="modal" aria-label="Close" class="text-decoration-none text-dark h-100 d-flex align-items-center justify-content-center" onclick="addFrom=1;">\n                <h1 style="font-size: 6rem;" class="mb-0"><i class="far fa-plus-square"></i></h1>\n            </a>\n        </div>\n    </div>',n.media.forEach(((t,a)=>{let d=document.createElement("div");classes(d,"col mb-4");let o=document.createElement("div");classes(o,"card text-light bg-dark"),d.appendChild(o);let c=document.createElement("img");classes(c,"card-img"),c.src=t.medUrl,o.appendChild(c);let i=document.createElement("div");classes(i,"card-img-overlay pt-0"),i.style.paddingLeft=".9rem",i.style.paddingRight=".9rem",o.appendChild(i);let s=document.createElement("div");classes(s,"row mb-2 p-0"),i.appendChild(s);let u=document.createElement("button");classes(u,"btn btn-light btn-scckie btn-sm"),u.innerHTML='<i class="fas fa-trash-alt"></i>',u.onclick=function(){var d;r==a?(r=-1,document.getElementById("btnAlrtClsSsn")&&document.getElementById("btnAlrtClsSsn").click(),"externo"!=t.medFile?(d=t.medFile,e.ref("cookieMedia/"+l+"/"+d).delete()).then((()=>{t.medUrl==n.picUrl&&(n.picUrl=""),n.media.splice(a,1),f()})).catch((e=>console.log(e))):(t.medUrl==n.picUrl&&(n.picUrl=""),n.media.splice(a,1),f())):("es"==lang?alertTop("<strong>¿Quieres eliminar esta imagen?</strong> Presiona de nuevo el botón para confirmar.",2):"en"==lang&&alertTop("<strong>Do you want to delete this image? </strong> Press the button again to confirm.",2),r=a,setTimeout((()=>{r=-1}),3e3))},s.appendChild(u);let p=document.createElement("div");classes(p,"tooltipn ml-auto");let h=document.createElement("button");classes(h,"btn btn-light btn-scckie btn-sm");let g=document.createElement("span");classes(g,"tooltipTextn"),g.innerHTML="Copiar",h.appendChild(g),h.innerHTML+='<i class="fas fa-link"></i>',h.onclick=function(){window.open(t.medUrl).focus(),g.innerHTML="URL copiado"},h.onmouseout=function(){g.innerHTML="Copiar"},p.appendChild(h),s.appendChild(p);let b=document.createElement("button"),E=document.createElement("button");t.medUrl==n.picUrl?(classes(b,"btn btn-light btn-scckie btn-sm ml-1"),b.innerHTML='<i class="fas fa-star"></i>',b.onclick=function(){n.picUrl="",f()},s.appendChild(b)):(classes(E,"btn btn-light btn-scckie btn-sm ml-1"),E.innerHTML='<i class="far fa-star"></i>',E.onclick=function(){n.picUrl=t.medUrl,f()},s.appendChild(E)),document.getElementById("contMedMan").appendChild(d);let v=document.createElement("div");classes(v,"col mb-4");let y=document.createElement("a");classes(y,"text-decoration-none"),y.setAttribute("type","button"),y.onclick=function(){-1!=m&&(n.cont[m].medUrl=t.medUrl,f())},y.setAttribute("data-dismiss","modal"),v.appendChild(y);let C=document.createElement("div");classes(C,"card text-light bg-dark"),y.appendChild(C);let T=document.createElement("img");classes(T,"card-img"),T.src=t.medUrl,C.appendChild(T),document.getElementById("contMedCho").appendChild(v)}))}function C(){let e;document.getElementById("cont").innerHTML="",n.beenPublic?e=n.published:n.published=e=new firebase.firestore.Timestamp.now,n.cont.forEach(((t,a)=>{let d=document.createElement("div");d.id="sect"+a;let s=document.createElement("div");classes(s,"dropdown-divider mx-2"),"head"!=t.type&&d.appendChild(s);let r=document.createElement("div");r.id="sect"+a+"t";let u=document.createElement("div");classes(u,"d-none"),u.id="sect"+a+"f";let p,h,b,E,v,y,T=document.createElement("div");classes(T,"row mb-2 px-2"),"head"!=t.type&&"ref"!=t.type&&(p=document.createElement("button"),classes(p,"btn btn-light btn-link-scckie ml-2"),p.innerHTML='<i class="fas fa-trash-alt"></i>',p.onclick=function(){o==a?(o=-1,document.getElementById("btnAlrtClsSsn")&&document.getElementById("btnAlrtClsSsn").click(),n.cont.splice(a,1),C(),f()):("es"==lang?alertTop("<strong>¿Quieres eliminar esta sección?</strong> Presiona de nuevo el botón para confirmar.",2):"en"==lang&&alertTop("<strong>Do you want to delete this section? </strong> Press the button again to confirm.",2),o=a,setTimeout((()=>{o=-1}),3e3))},T.appendChild(p));let k=document.createElement("div");if(classes(k,"col-auto"),y=document.createElement("select"),classes(y,"form-control mr-0 ml-2 h-100"),langs.forEach(((e,t)=>{if(e!=lang){let n=document.createElement("option");0==t&&n.setAttribute("selected","true"),n.value=n.innerText=e,y.appendChild(n)}})),"ref"!=t.type&&(k.appendChild(y),T.appendChild(k),v=document.createElement("button"),classes(v,"btn btn-light btn-link-scckie"),v.innerHTML='<i class="fas fa-language"></i>',v.onclick=function(){db.collection("cookies/langs/"+y.value).doc(l).get().then((async function(e){let l=e.data().cont[a];t.type==l.type&&("head"==l.type?n.cont[a].title=await g(l.title,y.value,lang):"html"==l.type?n.cont[a].html=await g(l.html,y.value,lang):"parra"==l.type?(n.cont[a].text=await g(l.text,y.value,lang),"0"!=l.title&&(n.cont[a].titleTxt=await g(l.titleTxt,y.value,lang))):"medSimple"==l.type&&(n.cont[a].alt=await g(l.alt,y.value,lang),n.cont[a].caption=await g(l.caption,y.value,lang)),console.log(n.cont[a]),f())})).catch((e=>console.log(e)))},T.appendChild(v),h=document.createElement("button"),classes(h,"btn btn-light btn-link-scckie ml-auto"),h.innerHTML='<i class="fas fa-edit"></i>',h.onclick=function(){if(toggleEl(h),toggleEl(b),toggleEl(u),"Se han guardado todos los cambios"==document.getElementById("tagLstSave").innerText){let e=Math.floor((Date.now()-i)/6e4);document.getElementById("tagLstSave").innerText=e>0?e>59?"Guardado hace "+Math.floor(e/60)+" horas":"Guardado hace "+e+" minutos":"Guardado hace "+Math.floor((Date.now()-i)/1e3)+" segundos"}},T.appendChild(h),b=document.createElement("button"),classes(b,"btn btn-light btn-link-scckie ml-auto d-none"),b.innerHTML='<i class="fas fa-check"></i>',b.onclick=function(){toggleEl(h),toggleEl(b),toggleEl(u),f()},T.appendChild(b),E=document.createElement("button"),classes(E,"btn btn-light btn-link-scckie mx-2"),E.innerHTML='<i class="fas fa-plus"></i>',E.setAttribute("data-toggle","modal"),E.setAttribute("data-target","#mdlPlusSect"),E.onclick=function(){c=a+1},T.appendChild(E)),d.appendChild(T),"head"==t.type){let t=e.toDate();t=t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear();let l=n.ledit.toDate();l=l.getDate()+"/"+(l.getMonth()+1)+"/"+l.getFullYear();let a=document.createElement("h1");classes(a,"text-center"),a.innerHTML=n.cont[0].title,r.appendChild(a);let d,o,c,i=document.createElement("p");if("es"==lang?(d="Publicado: ",o="Ultima actualización: ",c="Autor(es): "):"en"==lang&&(d="Published: ",o="Last updated: ",c="Author(s):"),i.innerText=d+t,r.appendChild(i),n.dledit){let e=document.createElement("p");e.innerText=o+l,r.appendChild(e)}let s=document.createElement("p");s.innerText=c+n.cont[0].author,r.appendChild(s);let m=document.createElement("div");classes(m,"row justify-content-center mb-2");let p=document.createElement("div");classes(p,"col col-lg-6");let h=document.createElement("input");classes(h,"form-control form-control-lg text-center"),h.setAttribute("type","text"),h.setAttribute("placeholder",n.cont[0].title),h.value=n.cont[0].title,p.appendChild(h),m.appendChild(p),u.appendChild(m),h.oninput=function(){n.title=n.cont[0].title=h.value.trim(),a.innerHTML=n.cont[0].title};let g=document.createElement("div");classes(g,"row mb-2");let b=document.createElement("label");classes(b,"col-sm-2 col-form-label"),b.innerText=d;let f=document.createElement("div");classes(f,"col");let E=document.createElement("input");classes(E,"form-control"),E.setAttribute("type","text"),E.setAttribute("readonly","true"),E.value=t,f.appendChild(E),g.appendChild(b),g.appendChild(f),u.appendChild(g);let v=document.createElement("div"),y=document.createElement("label"),C=document.createElement("div"),T=document.createElement("input");n.dledit&&(classes(v,"row mb-2"),classes(y,"col-sm-2 col-form-label"),y.innerText=o,classes(C,"col"),classes(T,"form-control"),T.setAttribute("type","text"),T.setAttribute("readonly","true"),T.value=l,C.appendChild(T),v.appendChild(y),v.appendChild(C),u.appendChild(v));let k=document.createElement("div");classes(k,"row mb-2");let w=document.createElement("label");classes(w,"col-sm-2 col-form-label"),w.innerText=c;let B=document.createElement("div");classes(B,"form-row justify-content-around pt-2");let M=document.createElement("div");classes(M,"form-group col-auto mr-2");let A=document.createElement("div");classes(A,"form-check"),M.appendChild(A);let x=document.createElement("input");classes(x,"form-check-input"),x.setAttribute("type","checkbox"),n.cont[0].author.includes(" Andrea Garma")&&x.setAttribute("checked","true"),x.value=" Andrea Garma";let L=document.createElement("label");classes(L,"form-check-label"),x.setAttribute("for","authr0"),L.innerText="Andrea Garma",A.appendChild(x),A.appendChild(L),B.appendChild(M);let P=document.createElement("div");classes(P,"form-group col-auto mr-2");let H=document.createElement("div");classes(H,"form-check"),P.appendChild(H);let U=document.createElement("input");classes(U,"form-check-input"),U.setAttribute("type","checkbox"),n.cont[0].author.includes(" Javier Pantoja")&&U.setAttribute("checked","true"),U.value=" Javier Pantoja";let N=document.createElement("label");classes(N,"form-check-label"),U.setAttribute("for","authr1"),N.innerText="Javier Pantoja",H.appendChild(U),H.appendChild(N),B.appendChild(P);let S=document.createElement("div");classes(S,"form-group col-auto mr-2");let D=document.createElement("div");classes(D,"form-check"),S.appendChild(D);let F=document.createElement("input");classes(F,"form-check-input"),F.setAttribute("type","checkbox"),n.cont[0].author.includes(" Paulina Vargas")&&F.setAttribute("checked","true"),F.value=" Paulina Vargas";let j=document.createElement("label");function I(e,t,l){let a=[];e&&a.push(" Andrea Garma"),t&&a.push(" Javier Pantoja"),l&&a.push(" Paulina Vargas"),a.empty&&a.push(" Anónimo"),n.cont[0].author=a.slice(),n.authors=a.slice(),s.innerText="Autor(es):"+n.cont[0].author}classes(j,"form-check-label"),F.setAttribute("for","authr2"),j.innerText="Paulina Vargas",D.appendChild(F),D.appendChild(j),B.appendChild(S),x.onclick=function(){I(x.checked,U.checked,F.checked)},U.onclick=function(){I(x.checked,U.checked,F.checked)},F.onclick=function(){I(x.checked,U.checked,F.checked)},k.appendChild(w),k.appendChild(B),u.appendChild(k)}else if("ref"==t.type){let e=document.createElement("h3");"es"==lang?e.innerHTML="<br>Referencias":"en"==lang&&(e.innerHTML="<br>References"),r.appendChild(e),t.ref.forEach(((e,t)=>{let l=document.createElement("div");classes(l,"row mb-2");let d=document.createElement("div");classes(d,"col"),l.appendChild(d);let o=document.createElement("div");classes(o,"col d-none"),l.appendChild(o);let c=document.createElement("div");classes(c,"col-auto"),l.appendChild(c);let s,m=document.createElement("p");function u(e){m.innerHTML=e}function p(e){m.innerHTML="",s=document.createElement("a"),classes(s,"text-warning text-break"),s.href=e,s.setAttribute("target","_blank"),s.setAttribute("rel","nofollow"),s.innerHTML=e+' <i class="fas fa-external-link-alt"></i>',m.appendChild(s)}function h(){y.value=y.value.trim(),n.cont[a].ref[t].link=v.value,n.cont[a].ref[t].type=y.value,"web"==e.type?(p(e.link),v.setAttribute("placeholder","https://google.com")):"cite"==e.type&&(u(e.link),v.setAttribute("placeholder","Ref"))}d.appendChild(m),"web"==e.type?p(e.link):"cite"==e.type&&u(e.link);let g=document.createElement("div");classes(g,"row");let b=document.createElement("div");classes(b,"col");let E=document.createElement("div");classes(E,"col-auto");let v=document.createElement("input"),y=document.createElement("select");classes(v,"form-control"),v.setAttribute("type","text"),v.value=e.link,"web"==e.type&&v.setAttribute("placeholder","https://google.com"),"cite"==e.type&&v.setAttribute("placeholder","Ref"),v.onchange=function(){h()},classes(y,"form-control form-control-sm");let T=document.createElement("option");T.value="web","web"==e.type&&T.setAttribute("selected","true"),T.innerText="Web",y.appendChild(T);let k,I,w=document.createElement("option");function B(){toggleEl(d),toggleEl(o),toggleEl(k),toggleEl(I)}"cite"==e.type&&w.setAttribute("selected","true"),w.value="cite",w.innerText="Otro",y.appendChild(w),y.onchange=function(){h()},b.appendChild(v),E.appendChild(y),g.appendChild(b),g.appendChild(E),o.appendChild(g),k=document.createElement("button"),classes(k,"btn btn-light btn-link-scckie ml-auto"),k.innerHTML='<i class="fas fa-edit"></i>',k.onclick=function(){B(),"Se han guardado todos los cambios"==document.getElementById("tagLstSave").innerText&&(document.getElementById("tagLstSave").innerText="Guardado hace "+Math.floor((Date.now()-i)/6e4)+" minutos")},I=document.createElement("button"),classes(I,"btn btn-light btn-link-scckie ml-auto d-none"),I.innerHTML='<i class="fas fa-check"></i>',I.onclick=function(){B(),n.cont[a].ref.sort(((e,t)=>{let n=e.link.toUpperCase(),l=t.link.toUpperCase();return n<l?-1:n>l?1:0})),f()},c.appendChild(k),c.appendChild(I);let M=document.createElement("button");classes(M,"btn btn-light btn-link-scckie ml-2"),M.innerHTML='<i class="fas fa-trash-alt"></i>',M.onclick=function(){n.cont[a].ref.splice(t,1),f(),C()},c.appendChild(M),r.appendChild(l),""==e.link&&k.click()}));let l=document.createElement("a");classes(l,"btn btn-light btn-scckie"),l.onclick=function(){w()},l.innerHTML='<i class="fas fa-plus"></i>',e.appendChild(l);let d=document.createElement("a");function w(){n.cont[a].ref.push({type:"web",link:""}),C()}classes(d,"btn btn-light btn-scckie btn-lg btn-block border border-light"),d.onclick=function(){w()},d.innerHTML='<i class="fas fa-plus"></i>',r.appendChild(d)}else if("parra"==t.type){let e;Number(t.title)>0&&(2==Number(t.title)&&(r.innerHTML="<br>"),e=document.createElement("h"+t.title),e.innerHTML=t.titleTxt,r.appendChild(e));let l=document.createElement("p");l.innerHTML=t.text,r.appendChild(l);let d=document.createElement("div");classes(d,"row");let o=document.createElement("div");classes(o,"col");let c=document.createElement("div");classes(c,"col-auto");let i=document.createElement("input"),s=document.createElement("select");classes(i,"form-control"),i.setAttribute("type","text"),Number(t.title)>0?(i.value=t.titleTxt,i.setAttribute("placeholder","Subtítulo"),i.removeAttribute("readonly")):(i.value="",i.setAttribute("placeholder",""),i.setAttribute("readonly","true")),i.oninput=function(){n.cont[a].titleTxt=e.innerHTML=i.value},classes(s,"form-control form-control-sm");for(let e=0;e<7;e++){let n=document.createElement("option");n.value=e,t.title==e&&n.setAttribute("selected","true"),n.innerText=e,s.appendChild(n)}s.oninput=function(){n.cont[a].title=s.value,Number(s.value)>0?(i.setAttribute("placeholder","Subtítulo"),i.removeAttribute("readonly"),2==Number(t.title)?r.innerHTML="<br>":r.innerHTML="",e=document.createElement("h"+t.title),e.innerHTML=n.cont[a].titleTxt=i.value,r.appendChild(e),r.appendChild(l)):(i.value="",i.setAttribute("placeholder",""),i.setAttribute("readonly","true"),n.cont[a].titleTxt=i.value,r.innerHTML="",r.appendChild(l))},o.appendChild(i),c.appendChild(s),d.appendChild(o),d.appendChild(c),u.appendChild(d);let m=document.createElement("div");classes(d,"row mb-2");let p=document.createElement("div");classes(o,"col");let g=document.createElement("textarea");classes(g,"form-control"),g.setAttribute("rows","8"),g.value=t.text,g.oninput=function(){n.cont[a].text=l.innerHTML=g.value.trim()},p.appendChild(g),m.appendChild(p),u.appendChild(m),Number(t.title)>0&&""==t.titleTxt&&h.click()}else if("html"==t.type){let e=document.createElement("div");e.innerHTML=t.html,r.appendChild(e);let l=document.createElement("div");classes(l,"row mb-2");let d=document.createElement("div");classes(d,"col");let o=document.createElement("textarea");classes(o,"form-control"),o.setAttribute("rows","8"),o.value=t.html,o.onchange=function(){n.cont[a].html=e.innerHTML=o.value.trim()},d.appendChild(o),l.appendChild(d),u.appendChild(l),""==t.html&&h.click()}else if("youtube"==t.type){let e=document.createElement("div");classes(e,"embed-responsive embed-responsive-"+t.ratio);let l=document.createElement("iframe");l.src=t.vidUrl,l.setAttribute("frameborder","0"),l.setAttribute("allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"),l.setAttribute("allowfullscreen","true"),e.appendChild(l),r.appendChild(e);let d=document.createElement("div");classes(d,"row");let o=document.createElement("div");classes(o,"col");let c=document.createElement("div");classes(c,"col-auto");let i=document.createElement("label");i.innerText="URL";let s=document.createElement("input");classes(s,"form-control"),s.setAttribute("type","text"),s.value=t.vidUrl,s.onchange=function(){let e=s.value.trim();if(11==e.length)e="https://www.youtube.com/embed/"+e;else{let t,n=1;do{t=e[n-1]+e[n],n++}while("e/"!=t&&"v="!=t);e="https://www.youtube.com/embed/"+e.substr(n,11)}n.cont[a].vidUrl=l.src=e};let m=document.createElement("small");classes(m,"text-muted"),m.innerText="aaaaaaaaaaa o https://youtu.be/aaaaaaaaaaa o https://www.youtube.com/watch?v=aaaaaaaaaaa";let p=document.createElement("label");p.innerText="Ratio";let g=document.createElement("select");classes(g,"form-control form-control-sm");let b=["21by9","16by9","4by3","1by1"];for(let e=0;e<4;e++){let n=document.createElement("option");n.value=b[e],t.ratio==b[e]&&n.setAttribute("selected","true"),n.innerText=b[e].replaceAll("by",":"),g.appendChild(n)}g.oninput=function(){n.cont[a].ratio=g.value,b.forEach((t=>{e.classList.remove("embed-responsive-"+t)})),classes(e,"embed-responsive-"+t.ratio)},o.appendChild(i),o.appendChild(s),o.appendChild(m),c.appendChild(p),c.appendChild(g),d.appendChild(o),d.appendChild(c),u.appendChild(d),""==t.vidUrl&&h.click()}else if("medSimple"==t.type){let e=document.createElement("figure");classes(e,"mx-auto"),e.style.width=t.width,e.style.position="relative",e.style.borderRadius=".25rem";let l=document.createElement("img");l.setAttribute("alt",t.alt),l.src=t.medUrl,classes(l,"w-100"),e.appendChild(l);let d=document.createElement("div");classes(d,"card-img-overlay pt-0"),d.style.paddingLeft=".9rem",d.style.paddingRight=".9rem";let o=document.createElement("div");classes(o,"row mb-2 p-0"),d.appendChild(o);let c=document.createElement("button");classes(c,"btn btn-light btn-scckie btn-sm ml-auto"),c.innerHTML='<i class="fas fa-exchange-alt"></i>',c.setAttribute("data-toggle","modal"),c.setAttribute("data-target","#mdlMedCho"),c.onclick=function(){m=a},o.appendChild(c),e.appendChild(d);let i=document.createElement("figcaption");i.style.fontSize="70%",i.style.fontWeight="lighter",i.innerHTML=t.caption,t.hasCapt&&e.appendChild(i),r.appendChild(e);let s=document.createElement("div");classes(s,"form-group mb-2");let p=document.createElement("label");p.innerText="Tamaño";let g=document.createElement("div");classes(g,"row");let b=document.createElement("div");classes(b,"col align-center d-flex pr-0");let f=document.createElement("input");f.setAttribute("type","range"),f.setAttribute("max","100"),f.setAttribute("min","0"),f.setAttribute("step","1"),f.value="75",classes(f,"form-control-range"),f.oninput=function(){E.innerHTML=f.value+"%",e.style.width=n.cont[a].width=f.value+"%"},b.appendChild(f);let E=document.createElement("span");classes(E,"badge badge-primary range-value-L"),E.innerText="75%";let v=document.createElement("div");classes(v,"col-auto"),v.appendChild(E),g.appendChild(b),g.appendChild(v),s.appendChild(p),s.appendChild(g),u.appendChild(s);let y=document.createElement("div");classes(y,"row");let C=document.createElement("div");classes(C,"col");let T=document.createElement("div");classes(T,"col-auto");let k=document.createElement("label");k.innerText="Pie de foto";let I=document.createElement("input");classes(I,"form-control"),I.setAttribute("type","text"),I.value=t.caption,I.oninput=function(){i.innerHTML=n.cont[a].caption=I.value.trim()};let w=document.createElement("select");classes(w,"form-control form-control-sm");let B=document.createElement("option");B.value="true","true"==t.hasCapt&&B.setAttribute("selected","true"),B.innerText="Sí",w.appendChild(B);let M=document.createElement("option");M.value="false","false"==t.hasCapt&&M.setAttribute("selected","true"),M.innerText="No",w.appendChild(M),w.oninput=function(){n.cont[a].hasCapt=w.value,"true"==w.value?(i.innerHTML=I.value=n.cont[a].caption,I.removeAttribute("readonly"),e.appendChild(i)):(I.value=n.cont[a].caption="",I.setAttribute("readonly","true"),i.innerHTML="",e.innerHTML="",e.appendChild(l),e.appendChild(d))},C.appendChild(k),C.appendChild(I),T.appendChild(w),y.appendChild(C),y.appendChild(T),u.appendChild(y);let A=document.createElement("div");classes(A,"row");let x=document.createElement("div");classes(x,"col");let L=document.createElement("label");L.innerText="Alt";let P=document.createElement("input");classes(P,"form-control"),P.setAttribute("type","text"),P.value=t.alt,P.oninput=function(){n.cont[a].alt=P.value.trim(),l.setAttribute("alt",P.value.trim())},x.appendChild(L),x.appendChild(P),A.appendChild(x),u.appendChild(A),"true"==t.hasCapt&&""==t.caption&&h.click()}d.appendChild(r),d.appendChild(u),document.getElementById("cont").appendChild(d)})),document.getElementById("inJava").innerText=n.java,document.getElementById("javaIns").innerHTML=n.java}window.loaded=function(){function t(){let e=document.getElementById("inFile").value;cookiesFSRef.where("file","==",e).get().then((t=>{t.empty||e==n.file?(n.description=document.getElementById("inDesc").value.trim(),n.file=e,f()):"es"==lang?alertTop("Ese nombre de archivo ya esta en uso.",0):"en"==lang&&alertTop("That file name is already in use.",0)})).then((()=>{console.log("exito")})).catch((e=>console.log(e)))}function d(t){let a=e.ref("cookieMedia/"+l+"/i"+t+u.name);a.getDownloadURL().then((e=>{d(t+1)})).catch((e=>{"storage/object-not-found"==e.code?a.put(u).on("state_changed",(function(e){E("barNewMed",e.bytesTransferred/e.totalBytes*100)}),(function(e){"es"==lang?alertTop("<strong>¡Ha ocurrido un error!</strong> "+e.code,0):"en"==lang&&alertTop("<strong>¡There has been an error!</strong> "+e.code,0),console.log(e),$("#mdlAddMed").modal("hide")}),(function(){a.getDownloadURL().then((e=>{n.media.push({medFile:"i"+t+u.name,medUrl:e}),f(),y(),$("#mdlAddMed").modal("hide"),$("#mdlMedCho").modal("show")})).catch((e=>{console.log(e)}))})):console.log(e)}))}allCats.forEach(((e,t)=>{let l=document.createElement("div");classes(l,"form-group col-auto");let a=document.createElement("div");classes(a,"form-check");let d=document.createElement("input");d.id="cat"+t,classes(d,"form-check-input"),d.value=e,d.setAttribute("type","checkbox"),d.onclick=function(){1==d.checked?n.fixedCats.push(this.value):n.fixedCats.splice(n.fixedCats.indexOf(this.value),1)},a.appendChild(d);let o=document.createElement("label");o.setAttribute("for","cat"+t),classes(o,"form-check-label"),o.innerText=textCats[t],a.appendChild(o),l.appendChild(a),document.getElementById("catFrmCont").appendChild(l)})),a=cookiesFSRef.doc(urlSrch.get("id")),a.onSnapshot((e=>{n=e.data(),l=e.id,document.getElementById("inFile").value=n.file,document.getElementById("inDesc").value=n.description,allCats.forEach(((e,t)=>{document.getElementById("cat"+t).checked=n.fixedCats.includes(document.getElementById("cat"+t).value)})),C(),y(),n.public?(document.getElementById("btnPrivate").classList.remove("d-none"),document.getElementById("btnAprove").classList.add("d-none"),document.getElementById("btnPub").classList.add("d-none")):(document.getElementById("btnPrivate").classList.add("d-none"),document.getElementById("btnAprove").classList.remove("d-none"),document.getElementById("btnPub").classList.remove("d-none")),n.revised[lang]&&n.revised[lang].includes(uid)?document.getElementById("btnAprove").innerHTML='<i class="fas fa-check-square"></i>':document.getElementById("btnAprove").innerHTML='<i class="far fa-check-square"></i>',document.getElementById("btnPrevCook").href=n.url,document.getElementById("btnPrevMail").href="../vista-email/"+n.file}),(e=>{console.log(e)})),langs.forEach((e=>{if(e!=lang){let t=document.createElement("option");t.value=t.innerText=e,document.getElementById("inTransFrom").appendChild(t)}})),document.getElementById("frmTranslate").addEventListener("submit",(function(e){e.preventDefault(),classes(document.getElementById("btnCnfTranslate"),"disabled"),classes(document.getElementById("btnCanTranslate0"),"disabled"),classes(document.getElementById("btnCanTranslate1"),"disabled"),E("barTranslate",0),showEl(document.getElementById("barTranslateCont")),v("barTranslate",0,73),firebase.app().functions("us-east1").httpsCallable("translations-translateFullCookie")({docId:l,from:document.getElementById("inTransFrom").value,target:lang}).then((e=>{v("barTranslate",73,90),e?(E("barTranslate",100),$("#mdlTranslate").modal("hide"),document.getElementById("btnCnfTranslate").classList.remove("disabled"),document.getElementById("btnCanTranslate0").classList.remove("disabled"),document.getElementById("btnCanTranslate1").classList.remove("disabled"),hideEl(document.getElementById("barTranslateCont"))):("es"==lang?alertTop("<strong>¡Ha ocurrido un error!</strong>",0):"en"==lang&&alertTop("<strong>¡There has been an error!</strong>",0),console.log("err"))}))})),document.getElementById("frmFile").addEventListener("submit",(function(e){e.preventDefault(),t()})),langs.forEach(((e,t)=>{if(e!=lang){let n=document.createElement("option");0==t&&n.setAttribute("selected","true"),n.value=n.innerText=e,document.getElementById("selFileTrans").appendChild(n)}})),document.getElementById("btnFileTrans").onclick=function(){let e=document.getElementById("selFileTrans").value;db.collection("cookies/langs/"+e).doc(l).get().then((async function(n){let l=n.data().file,a=n.data().description;document.getElementById("inFile").value=await g(l,e,lang),document.getElementById("inFile").value=document.getElementById("inFile").value.trim().toLowerCase().replaceAll(" ","-"),document.getElementById("inDesc").value=await g(a,e,lang),t()})).catch((e=>console.log(e)))},document.getElementById("frmAddMed").addEventListener("submit",(function(e){e.preventDefault(),E("barNewMed",0),showEl(document.getElementById("barNewMedCont")),hideEl(document.getElementById("frmAddMed")),document.getElementById("btnCnfNewMed").setAttribute("disabled","true"),document.getElementById("btnCanNewMed0").setAttribute("disabled","true"),document.getElementById("btnCanNewMed1").setAttribute("disabled","true"),"home"==p?d(0):(n.media.push({medFile:"externo",medUrl:document.getElementById("inNewMedUrl").value}),f(),$("#mdlAddMed").modal("hide"),$("#mdlMedCho").modal("show"))}))},window.plusSect=function(e){let t=null;"html"==e?t={type:e,html:""}:"parra"==e?t={type:e,text:"",title:"0"}:"youtube"==e?t={type:e,vidUrl:"",ratio:"16by9"}:"medSimple"==e&&(t={type:e,medUrl:"https://via.placeholder.com/150.webp",alt:"",caption:"",hasCapt:"true",width:"75%"}),null!=t&&n.cont.splice(c,0,t),C()},document.getElementById("inFile").oninput=function(){document.getElementById("inFile").value=ultraClean(document.getElementById("inFile").value,"-")},document.getElementById("inJava").onchange=function(){n.java=document.getElementById("javaIns").innerHTML=document.getElementById("inJava").value},document.getElementById("btnEditJs").onclick=function(){toggleEl(document.getElementById("btnEditJs")),toggleEl(document.getElementById("btnCheckJs")),document.getElementById("inJava").removeAttribute("readonly")},document.getElementById("btnCheckJs").onclick=function(){toggleEl(document.getElementById("btnEditJs")),toggleEl(document.getElementById("btnCheckJs")),document.getElementById("inJava").setAttribute("readonly","true"),f()},$("#mdlAddMed").on("hidden.bs.modal",(e=>{document.getElementById("prevNewMed").src="",document.getElementById("inNewMedL").innerHTML="Elige una imagen",document.getElementById("inNewMedUrl").value="",document.getElementById("inNewMed").removeAttribute("required"),document.getElementById("inNewMedUrl").removeAttribute("required"),hideEl(document.getElementById("barNewMedCont")),hideEl(document.getElementById("inNewMedFileCont")),hideEl(document.getElementById("inNewMedUrlCont")),showEl(document.getElementById("frmAddMed")),document.getElementById("btnCnfNewMed").removeAttribute("disabled"),document.getElementById("btnCanNewMed0").removeAttribute("disabled"),document.getElementById("btnCanNewMed1").removeAttribute("disabled")})),document.getElementById("inNewMed").addEventListener("change",(e=>{var t;u=e.target.files[0],u.name=ultraClean(u.name,""),document.getElementById("inNewMedL").innerHTML=u.name,(t=new FileReader).readAsDataURL(u),t.onload=function(e){document.getElementById("prevNewMed").src=e.target.result}})),document.getElementById("inNewMedUrl").onchange=function(){document.getElementById("prevNewMed").src=document.getElementById("inNewMedUrl").value},document.getElementById("inMedSrc0").onclick=function(){p="home",document.getElementById("inNewMed").setAttribute("required","true"),document.getElementById("inNewMedUrl").removeAttribute("required"),showEl(document.getElementById("inNewMedFileCont")),hideEl(document.getElementById("inNewMedUrlCont"))},document.getElementById("inMedSrc1").onclick=function(){p="out",document.getElementById("inNewMed").removeAttribute("required"),document.getElementById("inNewMedUrl").setAttribute("required","true"),hideEl(document.getElementById("inNewMedFileCont")),showEl(document.getElementById("inNewMedUrlCont"))},document.getElementById("inSendUpt").onclick=function(){document.getElementById("inSendUpt").checked?(showEl(document.getElementById("uptDescCont")),document.getElementById("inUptDesc").setAttribute("required","true")):(hideEl(document.getElementById("uptDescCont")),document.getElementById("inUptDesc").removeAttribute("required"))},document.getElementById("btnPrevCook").onclick=function(){n.timePrev=new firebase.firestore.Timestamp.fromMillis(new Date(Date.now()).getTime()+6e5),f()},document.getElementById("btnPrevMail").onclick=function(){n.timePrev=new firebase.firestore.Timestamp.fromMillis(new Date(Date.now()).getTime()+6e5),f()},document.getElementById("btnPrivate").onclick=function(){n.public=!1,f()},document.getElementById("btnAprove").onclick=function(){n.revised[lang]&&n.revised[lang].includes(uid)?(n.revised[lang].splice(n.revised[lang].indexOf(uid),1),document.getElementById("btnAprove").innerHTML='<i class="far fa-check-square"></i>'):(n.revised[lang]||(n.revised[lang]=[]),n.revised[lang].push(uid),document.getElementById("btnAprove").innerHTML='<i class="fas fa-check-square"></i>'),f()},$("#mdlAddMed").on("hiden.bs.modal",(e=>{document.getElementById("inMedSrc0").setAttribute("checked","false"),document.getElementById("inMedSrc1").setAttribute("checked","false"),document.getElementById("inNewMed").removeAttribute("required"),document.getElementById("inNewMedUrl").removeAttribute("required"),hideEl(document.getElementById("inNewMedFileCont")),hideEl(document.getElementById("inNewMedUrlCont"))})),$("#mdlPublish").on("show.bs.modal",(e=>{let t=0;langs.forEach((e=>{let l=n.revised[e]?n.revised[e].length:0;n.revised[e]&&!n.revised[e].includes(uid)&&l++,l>=2&&t++})),t==langs.length?(classes(document.getElementById("btnCnfPublish"),"d-none"),document.getElementById("mdlPublishTxt").innerText="Para publicar es necesario que lo hayan aprovado al menos dos personas.",document.getElementById("frmPublish").classList.add("d-none")):(document.getElementById("btnCnfPublish").classList.remove("d-none"),document.getElementById("mdlPublishTxt").innerText="La galleta está lista para publicar",document.getElementById("frmPublish").classList.remove("d-none"),n.beenPublic&&document.getElementById("sendUptCont").classList.remove("d-none"))})),document.getElementById("btnCnfPublish").onclick=function(){n.public||(E("barPublish",0),showEl(document.getElementById("barPublishCont")),n.public=!0,n.ledit=new firebase.firestore.Timestamp.now,n.beenPublic=!0,n.revised={},E("barPublish",31),n.beenPublic?(document.getElementById("inSendUpt").checked?(n.dledit=!0,n.notify=!0):(n.dledit=!1,n.notify=!1),E("barPublish",45),document.getElementById("inSendUpt").checked?(n.uptMsg=!0,n.uptDescrip=document.getElementById("inUptDesc").value.trim()):(n.uptMsg=!1,n.uptDescrip=""),E("barPublish",62)):(n.notify=!0,n.published=new firebase.firestore.Timestamp.now,E("barPublish",62)),b().then((()=>{t.ref("galletas/"+l).set({pop:n.pop,likes:n.likes,favs:n.favs},(e=>{e?console.log("Data could not be saved."+e):(E("barPublish",84),E("barPublish",100),classes(document.getElementById("barPublish"),"bg-success"),"es"==lang?alertTop("Publicado correctamente",1):"en"==lang&&alertTop("Published successfully",1),setTimeout((function(){window.open(n.url,"_blank").focus()}),2500),console.log("Data saved successfully."),$("#mdlPublish").modal("hide"))}))})).catch((e=>{"es"==lang?alertTop("<strong>¡Ha ocurrido un error!</strong> "+e.code,0):"en"==lang&&alertTop("<strong>¡There has been an error!</strong> "+e.code,0),console.log(e)})))}}();
//# sourceMappingURL=edit.js.map
